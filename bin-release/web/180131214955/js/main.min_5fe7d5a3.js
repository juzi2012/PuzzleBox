var __reflect=this&&this.__reflect||function(t,e,o){t.__class__=e,o?o.push(e):o=[e],t.__types__=t.__types__?o.concat(t.__types__):o},__extends=this&&this.__extends||function(t,e){function o(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);o.prototype=e.prototype,t.prototype=new o},__awaiter=this&&this.__awaiter||function(t,e,o,r){return new(o||(o=Promise))(function(n,i){function s(t){try{h(r.next(t))}catch(e){i(e)}}function a(t){try{h(r["throw"](t))}catch(e){i(e)}}function h(t){t.done?n(t.value):new o(function(e){e(t.value)}).then(s,a)}h((r=r.apply(t,e||[])).next())})},__generator=this&&this.__generator||function(t,e){function o(t){return function(e){return r([t,e])}}function r(o){if(n)throw new TypeError("Generator is already executing.");for(;h;)try{if(n=1,i&&(s=i[2&o[0]?"return":o[0]?"throw":"next"])&&!(s=s.call(i,o[1])).done)return s;switch(i=0,s&&(o=[0,s.value]),o[0]){case 0:case 1:s=o;break;case 4:return h.label++,{value:o[1],done:!1};case 5:h.label++,i=o[1],o=[0];continue;case 7:o=h.ops.pop(),h.trys.pop();continue;default:if(s=h.trys,!(s=s.length>0&&s[s.length-1])&&(6===o[0]||2===o[0])){h=0;continue}if(3===o[0]&&(!s||o[1]>s[0]&&o[1]<s[3])){h.label=o[1];break}if(6===o[0]&&h.label<s[1]){h.label=s[1],s=o;break}if(s&&h.label<s[2]){h.label=s[2],h.ops.push(o);break}s[2]&&h.ops.pop(),h.trys.pop();continue}o=e.call(t,h)}catch(r){o=[6,r],i=0}finally{n=s=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}var n,i,s,a,h={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return a={next:o(0),"throw":o(1),"return":o(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a},Module=function(t){function e(){var e=t.call(this)||this;return e.isDisposed=!1,e}return __extends(e,t),Object.defineProperty(e.prototype,"moduleId",{get:function(){return null!=ModuleInfoVo?this.moduleInfoVo.moduleId:0},enumerable:!0,configurable:!0}),e.prototype.initContent=function(){},e.prototype.initContentAll=function(){this.initContent(),this.init()},e.prototype.init=function(){},e.prototype.addChildDisplayObj=function(t){this.content&&this.content.displayObject&&this.content.displayObject instanceof egret.DisplayObjectContainer?this.content.displayObject.addChild(t):egret.error(this+".content不存在，添加displayObj失败")},e.prototype.initAutoSize=function(t,e){this.content&&e&&(this.content.setSize(t.width,t.height),this.content.addRelation(t,fairygui.RelationType.Size))},e.prototype.moduleServerStart=function(t){this.moduleServerCpl()},e.prototype.moduleServerCpl=function(){this.dispatchEvent(new egret.Event(ModuleConsts.MODULE_SERVER_CPL))},e.prototype.preShow=function(t){this.preShowCpl()},e.prototype.preShowCpl=function(){this.dispatchEvent(new egret.Event(ModuleConsts.MODULE_PRE_SHOW_CPL))},e.prototype.show=function(t){},e.prototype.preClose=function(t){this.preCloseCpl()},e.prototype.preCloseCpl=function(){this.dispatchEvent(new egret.Event(ModuleConsts.MODULE_PRE_CLOSE_CPL))},e.prototype.hide=function(){this.content.parent&&this.content.parent.removeChild(this.content)},e.prototype.releaseContent=function(){},e.prototype.release=function(){0==this.isDisposed&&(this.hide(),this.releaseContent(),this.isDisposed=!0)},e.prototype.getHistoryData=function(){return null},e.prototype.moduleFadeIn=function(t){this.moduleFadeInCpl()},e.prototype.moduleFadeInCpl=function(){this.dispatchEvent(new egret.Event(ModuleConsts.MODULE_FADE_IN_CPL))},e.prototype.moduleFadeOut=function(){this.moduleFadeOutCpl()},e.prototype.moduleFadeOutCpl=function(){this.dispatchEvent(new egret.Event(ModuleConsts.MODULE_FADE_OUT_CPL))},e.prototype.setVisible=function(t){this.content.visible=t},e}(egret.EventDispatcher);__reflect(Module.prototype,"Module");var UILayer=function(t){function e(){var e=t.call(this)||this;return e.p_moduleList=new Array,e.setSize(fairygui.GRoot.inst.width,fairygui.GRoot.inst.height),e.addRelation(fairygui.GRoot.inst,fairygui.RelationType.Size),e.touchable=!0,e}return __extends(e,t),e.prototype.getCurModuleInfo=function(){return this.p_moduleList.length>0?this.p_moduleList[this.p_moduleList.length-1]:null},e.prototype.getCurModuleId=function(){var t=this.getCurModuleInfo();return t?t.moduleId:0},e.prototype.showModule=function(t,e,o){var r=this.getModuleInfoVo(t);if(null==r){var n=ModuleMgr.ins.getConfigVo(t);if(null==n)return;r=new ModuleInfoVo(n),this.p_moduleList.push(r),r.layer=this,r.preShowData=e,r.changeModuleState(ModuleConsts.STATE_SHOW),r.addEventListener(ModuleConsts.MODULE_ADD_TO_STAGE,this.onModuleAddToStage,this)}else r.changeModuleState(ModuleConsts.STATE_SHOW),r.module.content.parent?r.addEventListener(ModuleConsts.MODULE_ADD_TO_STAGE,this.onModuleAddToStage,this):this.onModuleAddToStage(null);return r},e.prototype.onModuleAddToStage=function(t){},e.prototype.isShow=function(t){var e=this.getModuleInfoVo(t);return e?e.isShow:!1},e.prototype.closeModule=function(t,e){var o=this.getModuleInfoVo(t);null!=o&&this.closeModuleByInfo(o,e)},e.prototype.closeModuleByInfo=function(t,e){t.isShow&&(t.addEventListener(ModuleConsts.MODULE_CLOSE_CPL,this.onCloseCpl,this),t.preShowData=e,t.changeModuleState(ModuleConsts.STATE_CLOSE))},e.prototype.onCloseCpl=function(t){var e=t.currentTarget;if(e.removeEventListener(ModuleConsts.MODULE_CLOSE_CPL,this.onCloseCpl,this),e.configVo.disposeWhenClose){var o=this.p_moduleList.lastIndexOf(e);o>=0&&this.p_moduleList.splice(o,1),e.release()}},e.prototype.getModuleInfoVo=function(t){for(var e=this.p_moduleList.length-1;e>=0;e--)if(this.p_moduleList[e].moduleId==t)return this.p_moduleList[e];return null},e.prototype.closeAll=function(t){for(var e=this.p_moduleList.length-1;e>=0;e--){var o=this.p_moduleList[e];t&&t.indexOf(o.moduleId)>=0||this.closeModuleByInfo(o)}},e}(fairygui.GComponent);__reflect(UILayer.prototype,"UILayer");var core;!function(t){var e=function(){function t(){}return t}();t.Progress=e,__reflect(e.prototype,"core.Progress")}(core||(core={}));var core;!function(t){var e=function(){function t(t,e){this.callback=t,this.thisObj=e}return t}();t.Callback=e,__reflect(e.prototype,"core.Callback")}(core||(core={}));var Dictionary=function(){function t(){this.m_keys=[],this.m_values=[]}return Object.defineProperty(t.prototype,"length",{get:function(){return this.m_keys.length},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"values",{get:function(){return this.m_values.concat()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"keys",{get:function(){return this.m_keys.concat()},enumerable:!0,configurable:!0}),t.prototype.indexOf=function(t){return this.m_keys.indexOf(t)},t.prototype.add=function(t,e){var o=this.indexOf(t);o>=0?this.m_values[o]=e:(this.m_keys.push(t),this.m_values.push(e))},t.prototype.get=function(t){var e=this.indexOf(t);return e>=0?this.m_values[e]:null},t.prototype.remove=function(t){var e=this.indexOf(t);return e>=0?(this.m_keys.splice(e,1),this.m_values.splice(e,1)[0]):null},t.prototype.clear=function(){this.m_keys.length=0,this.m_values.length=0},t.prototype.getRandomData=function(){var t=Math.random()*this.keys.length<<0;return this.m_values[t]},t}();__reflect(Dictionary.prototype,"Dictionary");var core;!function(t){var e=function(t){function e(e,o){var r=t.call(this)||this;return r.messageID=e,r.messageData=o,r}return __extends(e,t),e}(egret.HashObject);t.EventData=e,__reflect(e.prototype,"core.EventData",["core.IMessage"])}(core||(core={}));var core;!function(t){var e=function(){function t(){}return t.getInstance=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var o=this;if(!o._instance){var r=t.length;0==r?o._instance=new o:1==r?o._instance=new o(t[0]):2==r?o._instance=new o(t[0],t[1]):3==r?o._instance=new o(t[0],t[1],t[2]):4==r?o._instance=new o(t[0],t[1],t[2],t[3]):5==r&&(o._instance=new o(t[0],t[1],t[2],t[3],t[4]))}return o._instance},t}();t.BaseClass=e,__reflect(e.prototype,"core.BaseClass")}(core||(core={}));var BoxSingle=function(t){function e(e){var o=t.call(this)||this;return o.color=e,o.createBitmap(),o}return __extends(e,t),e.prototype.createBitmap=function(){switch(this.color){case 1:this.pic_name="red";break;case 2:this.pic_name="yellow";break;case 3:this.pic_name="blue";break;case 4:this.pic_name="green";break;case 5:this.pic_name="purple"}this.pic=Utils.createFairyGuiBitmapByName(this.pic_name),this.pic.width=GameConsts.GAME_TILE_WIDHT_AND_HEIGHT,this.pic.height=GameConsts.GAME_TILE_WIDHT_AND_HEIGHT,this.pic.anchorOffsetX=GameConsts.GAME_TILE_WIDHT_AND_HEIGHT/2,this.pic.anchorOffsetY=GameConsts.GAME_TILE_WIDHT_AND_HEIGHT/2,this.addChild(this.pic)},e.prototype.setPosXY=function(t,e){this.posx=t,this.posy=e},e}(egret.DisplayObjectContainer);__reflect(BoxSingle.prototype,"BoxSingle");var game;!function(t){var e=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.createInstance=function(){return fairygui.UIPackage.createObject("game","FloatScore")},e.prototype.constructFromXML=function(e){t.prototype.constructFromXML.call(this,e),this.m_txt_score=this.getChildAt(0),this.m_showmovie=this.getTransitionAt(0)},e.URL="ui://7cac2uhfrzcxm",e}(fairygui.GComponent);t.UI_FloatScore=e,__reflect(e.prototype,"game.UI_FloatScore")}(game||(game={}));var UIModuleLayer=function(t){function e(){var e=t.call(this)||this;return e.p_historyList=new Array,e}return __extends(e,t),e.prototype.showModule=function(e,o,r){var n=this.getCurModuleInfo();return null!=n&&(this.addHistory(n.moduleId,n.preShowData,n.getHistoryData()),this.closeModuleByInfo(n,null)),t.prototype.showModule.call(this,e,o,r)},e.prototype.closeModule=function(t,e){var o=this.getCurModuleId(),r=this.getModuleInfoVo(t);if(null!=r&&this.closeModuleByInfo(r,e),t==o&&this.p_historyList.length>0){var n=this.p_historyList.pop();this.showModule(n.moduleId,n.historyData?n.historyData:n.data)}},e.prototype.closeModuleByInfo=function(e,o){t.prototype.closeModuleByInfo.call(this,e,o)},e.prototype.addHistory=function(t,e,o){this.p_historyList.push(new HistoryModuleVo(t,e,o))},e}(UILayer);__reflect(UIModuleLayer.prototype,"UIModuleLayer");var PopModuleView=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.init=function(){this.moduleFadeInType=ModuleConsts.MODULE_FADE_IN_TYPE_1,this.moduleFadeOutType=ModuleConsts.MODULE_FADE_OUT_TYPE_1},e.prototype.initAutoSize=function(t,e){this.content&&e&&(this.content.x=t.width/2-this.content.width/2,this.content.y=t.height/2-this.content.height/2,this.content.addRelation(t,fairygui.RelationType.Center_Center))},e.prototype.moduleFadeIn=function(t){switch(this.moduleFadeInType){case ModuleConsts.MODULE_FADE_IN_TYPE_1:var o=new core.Vector2D(this.content.x,this.content.y),r=.5;this.content.x=this.content.x+this.content.width/2*r,this.content.y=this.content.y+this.content.height/2*r,this.content.scaleX=this.content.scaleY=r,this.content.alpha=0;var n=egret.Tween.get(this.content);n.to({x:o.x,y:o.y,scaleX:1,scaleY:1,alpha:1},e.TWEEN_DURATION,egret.Ease.quintOut),n.call(this.moduleFadeInCpl,this);break;case ModuleConsts.MODULE_FADE_IN_TYPE_2:var o=new core.Vector2D(this.content.x,this.content.y);this.content.y=LayerCenter.stageHeight/2+50,this.content.alpha=0,n=egret.Tween.get(this.content),n.to({y:o.y,alpha:1},e.TWEEN_DURATION,egret.Ease.quintOut),n.call(this.moduleFadeInCpl,this);break;default:this.moduleFadeInCpl()}},e.prototype.moduleFadeInCpl=function(){t.prototype.moduleFadeInCpl.call(this)},e.prototype.moduleFadeOut=function(){switch(this.moduleFadeOutType){case ModuleConsts.MODULE_FADE_OUT_TYPE_1:var t=.5,o=this.content.x+this.content.width/2*t,r=this.content.y+this.content.height/2*t,n=egret.Tween.get(this.content);n.to({x:o,y:r,scaleX:t,scaleY:t,alpha:.5},e.TWEEN_DURATION,egret.Ease.quintIn),n.call(this.moduleFadeOutCpl,this);break;case ModuleConsts.MODULE_FADE_OUT_TYPE_2:r=LayerCenter.stageHeight/2+50,n=egret.Tween.get(this.content),n.to({y:r,alpha:0},e.TWEEN_DURATION,egret.Ease.quintIn),n.call(this.moduleFadeOutCpl,this);break;default:this.moduleFadeOutCpl()}},e.prototype.moduleFadeOutCpl=function(){t.prototype.moduleFadeOutCpl.call(this)},e.TWEEN_DURATION=200,e}(Module);__reflect(PopModuleView.prototype,"PopModuleView");var core;!function(t){var e=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.removeFromParent=function(){this.parent&&this.parent.removeChild(this)},e}(egret.DisplayObjectContainer);t.Component=e,__reflect(e.prototype,"core.Component",["core.IComponent"])}(core||(core={}));var core;!function(t){var e=function(){function t(){RES.addEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.addEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,this.onResourceLoadError,this)}return t.prototype.onResourceLoadError=function(t){this.m_groupData.curGroup==t.groupName&&(egret.log("资源组："+t.groupName+" 加载失败"),this.m_groupData.curGroupLoaded=t.itemsLoaded,this.m_groupData.curGroupTotal=t.itemsTotal,this.m_groupData.curResItem=t.resItem,this.m_groupData.onLoadFaild&&this.m_groupData.onLoadFaild.call(this.m_groupData.thisObj,this.m_groupData))},t.prototype.onResourceProgress=function(t){this.updateGroupData(t.groupName,t.itemsLoaded,t.itemsTotal,t.resItem)},t.prototype.onResourceLoadComplete=function(t){egret.log("资源组："+t.groupName+" 加载完成"),this.updateGroupData(t.groupName,t.itemsTotal,t.itemsTotal,t.resItem)},t.prototype.updateGroupData=function(t,e,o,r){void 0===e&&(e=0),void 0===o&&(o=0),this.m_groupData.curGroup==t&&(this.m_groupData.curGroupLoaded=e,this.m_groupData.curGroupTotal=o,this.m_groupData.curResItem=r,this.m_groupData.onLoadProgress&&this.m_groupData.onLoadProgress.call(this.m_groupData.thisObj,this.m_groupData),e==o&&(this.m_groupData.loadedQueue.push(t),this.m_groupData.loaded=this.m_groupData.loadedQueue.length,this.loadNext()))},t.prototype.loadNext=function(){var t=this.m_groupData.loadQueue.shift();t?(this.m_groupData.curGroup=t,RES.isGroupLoaded(t)||this.m_groupData.loadedQueue.indexOf(t)>=0?this.updateGroupData(t,this.m_groupData.total,this.m_groupData.total,this.m_groupData.curResItem):RES.loadGroup(t)):(this.m_groupData.onLoadComplete&&this.m_groupData.onLoadComplete.call(this.m_groupData.thisObj,this.m_groupData),this.destory())},t.prototype.destory=function(){RES.removeEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.removeEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.removeEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,this.onResourceLoadError,this),this.m_groupData=null},t.prototype.loadGroups=function(t){this.m_groupData=t,this.loadNext()},t}();__reflect(e.prototype,"GroupLoader");var o=function(){function o(){}return o.loadGroups=function(t,o,n,i,s,a){if(t){var h=new r;if(h.loadQueue=t,h.loadedQueue=[],h.loaded=0,h.total=t.length,h.onLoadProgress=o,h.onLoadFaild=n,h.onLoadComplete=i,h.thisObj=s,h.param=a,t.length>0){var u=new e;u.loadGroups(h)}else i&&i.call(s,h)}},o.prototype.getCacheRes=function(e){var o=t.CachePool.getObj(e);return o||(o=RES.getRes(e),o.key=e),o},o.prototype.revertCacheRes=function(e){e&&e.key&&t.CachePool.addObj(e.key,e)},o.loadExmls=function(t,e,o){e.apply(o)},o.parsedSkinClasses={},o}();t.ResUtils=o,__reflect(o.prototype,"core.ResUtils");var r=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(t.Progress);t.GroupData=r,__reflect(r.prototype,"core.GroupData")}(core||(core={}));var core;!function(t){var e=function(){function e(e,o){if(void 0===o&&(o=!1),this.m_list=[],e)for(var r=0,n=e.length;n>r;r++){var i=new t.Node(e[r]);this.m_list.push(i)}for(var s=this.m_list,r=0,n=s.length;n>r;r++){var i=s[r];r+1==n?i.nextNode=o?s[0]:null:i.nextNode=s[r+1],0==r?i.preNode=o?s[n-1]:null:i.preNode=s[r-1]}}return e.prototype.getLen=function(){return this.m_list.length},e.prototype.getFirst=function(){return this.m_list[0]},e.prototype.getEnd=function(){return this.m_list[this.m_list.length-1]},e.prototype.getNode=function(t){return this.m_list[t]},e.prototype.clear=function(){this.m_list.length=0},e}();t.NodeList=e,__reflect(e.prototype,"core.NodeList")}(core||(core={}));var Keyboard;!function(t){t[t.BACKSPACE=8]="BACKSPACE",t[t.TAB=9]="TAB",t[t.ENTER=13]="ENTER",t[t.SHIFT=16]="SHIFT",t[t.CTRL=17]="CTRL",t[t.ALT=18]="ALT",t[t.CAPSLOCK=20]="CAPSLOCK",t[t.ESC=27]="ESC",t[t.SPACE=32]="SPACE",t[t.PAGEUP=33]="PAGEUP",t[t.PAGEDOWN=34]="PAGEDOWN",t[t.END=35]="END",t[t.HOME=36]="HOME",t[t.LEFT=37]="LEFT",t[t.UP=38]="UP",t[t.RIGHT=39]="RIGHT",t[t.DOWN=40]="DOWN",t[t.INSERT=45]="INSERT",t[t.DELETE=46]="DELETE",t[t.NUM_0=48]="NUM_0",t[t.NUM_1=49]="NUM_1",t[t.NUM_2=50]="NUM_2",t[t.NUM_3=51]="NUM_3",t[t.NUM_4=52]="NUM_4",t[t.NUM_5=53]="NUM_5",t[t.NUM_6=54]="NUM_6",t[t.NUM_7=55]="NUM_7",t[t.NUM_8=56]="NUM_8",t[t.NUM_9=57]="NUM_9",t[t.A=65]="A",t[t.B=66]="B",t[t.C=67]="C",t[t.D=68]="D",t[t.E=69]="E",t[t.F=70]="F",t[t.G=71]="G",t[t.H=72]="H",t[t.I=73]="I",t[t.J=74]="J",t[t.K=75]="K",t[t.L=76]="L",t[t.M=77]="M",t[t.N=78]="N",t[t.O=79]="O",t[t.P=80]="P",t[t.Q=81]="Q",t[t.R=82]="R",t[t.S=83]="S",t[t.T=84]="T",t[t.U=85]="U",t[t.V=86]="V",t[t.W=87]="W",t[t.X=88]="X",t[t.Y=89]="Y",t[t.Z=90]="Z",t[t.NUMPAD_0=96]="NUMPAD_0",t[t.NUMPAD_1=97]="NUMPAD_1",t[t.NUMPAD_2=98]="NUMPAD_2",t[t.NUMPAD_3=99]="NUMPAD_3",t[t.NUMPAD_4=100]="NUMPAD_4",t[t.NUMPAD_5=101]="NUMPAD_5",t[t.NUMPAD_6=102]="NUMPAD_6",t[t.NUMPAD_7=103]="NUMPAD_7",t[t.NUMPAD_8=104]="NUMPAD_8",t[t.NUMPAD_9=105]="NUMPAD_9",t[t.F1=112]="F1",t[t.F2=113]="F2",t[t.F3=114]="F3",t[t.F4=115]="F4",t[t.F5=116]="F5",t[t.F6=117]="F6",t[t.F7=118]="F7",t[t.F8=119]="F8",t[t.F9=120]="F9",t[t.F10=121]="F10",t[t.F11=122]="F11",t[t.F12=123]="F12"}(Keyboard||(Keyboard={}));var core;!function(t){var e=function(){function t(){this.m_keyMap=new Dictionary}return t.prototype.addKeyListener=function(t,e,n){var i=this.m_keyMap.get(t);i||(i=new o(t)),i.callbacks.push(new r(e,n)),this.m_keyMap.add(t,i)},t.prototype.removeKeyListener=function(t,e,o){var r=this.m_keyMap.get(t);if(r)for(var n=r.callbacks,i=0,s=n.length;s>i;i++){var a=n[i];a&&a.callback===e&&a.thisObj===o&&(a.isValid=!1)}},t.prototype.enableKey=function(t,e){this.m_keyMap.get(t).keyEnable=e},t.prototype.enable=function(t){for(var e=this.m_keyMap,o=e.values,r=0,n=o.length;n>r;r++)o[r].keyEnable=t},t.prototype.sendKey=function(t){var e=this.m_keyMap.get(t);if(e){for(var o=e.callbacks,r=o.length;r>0;r--){var n=o[r-1];n.isValid||o.splice(r-1,1)}for(var r=0,i=o.length;i>r;r++){var s=o[r];s.callback.call(s.thisObj)}}},t.getInstance=function(){return t.s_instance||(t.s_instance=new t),t.s_instance},t}();t.InputManager=e,__reflect(e.prototype,"core.InputManager");var o=function(){function t(t){this.key=t,this.keyEnable=!0,this.callbacks=[]}return t}();__reflect(o.prototype,"KeyData");var r=function(t){function e(e,o){var r=t.call(this,e,o)||this;return r.isValid=!0,r}return __extends(e,t),e}(t.Callback);__reflect(r.prototype,"KeyCallBack")}(core||(core={}));var core;!function(t){var e=function(){function t(){}return t.MODULE_SHOW="core.EventID.MODULE_SHOW",t.MODULE_HIDE="core.EventID.MODULE_HIDE",t.SOCKET_CONNECT="core.EventID.SOCKET_CONNECT",t.SOCKET_DATA="core.EventID.SOCKET_DATA",t.SOCKET_IOERROR="core.EventID.SOCKET_IOERROR",t.SOCKET_CLOSE="core.EventID.SOCKET_CLOSE",t.KEYBOARD_DOWN="core.EventID.KEYBOARD_DOWN",t.KEYBOARD_UP="core.EventID.KEYBOARD_UP",t.CREATE_ROLE="core.EventID.CREATE_ROLE",t}();t.EventID=e,__reflect(e.prototype,"core.EventID")}(core||(core={}));var core;!function(t){var e=function(t){function e(e,o){return t.call(this,e,o)||this}return __extends(e,t),e.prototype.getData=function(){return this.messageData},e}(t.EventData);t.KeyboardEventData=e,__reflect(e.prototype,"core.KeyboardEventData")}(core||(core={}));var core;!function(t){var e=function(t){function e(e,o,r){var n=t.call(this,e,r)||this;return n.moduleEnum=o,n}return __extends(e,t),e}(t.EventData);t.ModuleEventData=e,__reflect(e.prototype,"core.ModuleEventData")}(core||(core={}));var BindFGuiTask=function(){function t(){this.exec()}return t.prototype.exec=function(){game.gameBinder.bindAll()},t}();__reflect(BindFGuiTask.prototype,"BindFGuiTask");var RegModuleTask=function(){function t(){this.exec()}return t.prototype.exec=function(){this.regModule(ModuleEnum.GAME,LayerEnum.SCENE,Game,[]),this.regModule(ModuleEnum.GameOver,LayerEnum.POPUP,GameOverModule,[]),this.regModule(ModuleEnum.GAME_TOP,LayerEnum.STATIC,GameTop,[])},t.prototype.regModule=function(t,e,o,r){void 0===r&&(r=null);var n=new ModuleConfigVo;switch(n.moduleId=t,n.layerKind=e,n.moduleCls=o,n.groupNames=r,e){case LayerEnum.SCENE:n.setIsAutoSize(!0);break;case LayerEnum.UI:n.setIsAutoSize(!0);break;case LayerEnum.STATIC:n.setIsAutoSize(!1),n.setDisposeWhenClose(!1);break;case LayerEnum.POPUP:n.setIsAutoSize(!0),n.setShowCover(!0);break;case LayerEnum.TOP:n.setIsAutoSize(!1)}return ModuleMgr.ins.regModule(n),n},t.prototype.checkHasSameId=function(){},t}();__reflect(RegModuleTask.prototype,"RegModuleTask");var RegRunTimeClassTask=function(){function t(){this.exec()}return t.prototype.exec=function(){fairygui.UIObjectFactory.setPackageItemExtension(game.UI_FloatScore.URL,FloatScore)},t}();__reflect(RegRunTimeClassTask.prototype,"RegRunTimeClassTask");var core;!function(t){var e=function(){function t(){}return t.getLoading=function(e){var o=t.s_loading.get(e);return o||e&&(o=new e,t.s_loading.add(e,o)),o},t.getCurLoading=function(){return t.s_curLoading},t.setCurLoading=function(e){var o=t.s_loading.get(e);return o||e&&(o=new e,t.s_loading.add(e,o)),t.s_curLoading=o,o},t.s_loading=new Dictionary,t}();t.LoadingManager=e,__reflect(e.prototype,"core.LoadingManager")}(core||(core={}));var core;!function(t){var e=function(e){function o(t){return e.call(this,t)||this}return __extends(o,e),o.prototype.readUTFData=function(){var t=this.readShort();return e.prototype.readUTFBytes.call(this,t)},o.prototype.writeUTFBytes=function(t){this.writeShort(this.getStringBytesLen(t)),e.prototype.writeUTFBytes.call(this,t)},o.prototype.getStringBytesLen=function(t){var e=new egret.ByteArray;return e.writeUTFBytes(t),e.length},o.prototype.clone=function(){var e=new t.ByteBuffer;return e.writeBytes(this),e},o}(egret.ByteArray);t.ByteBuffer=e,__reflect(e.prototype,"core.ByteBuffer")}(core||(core={}));var HttpAPI=function(){function t(){}return t.HttpGET=function(t,e,o,r,n){var i=e?t+"?"+encodeURI(this.encode(e)):t,s=new egret.HttpRequest;s.responseType=egret.HttpResponseType.TEXT,s.addEventListener(egret.Event.COMPLETE,o,n),s.addEventListener(egret.IOErrorEvent.IO_ERROR,r,n),s.open(i,egret.HttpMethod.GET),s.send()},t.HttpPOST=function(t,e,o,r,n){var i=new egret.HttpRequest;i.responseType=egret.HttpResponseType.TEXT,i.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),i.addEventListener(egret.Event.COMPLETE,o,n),i.addEventListener(egret.IOErrorEvent.IO_ERROR,r,n),i.open(t,egret.URLRequestMethod.POST),i.send(e)},t.encode=function(t){var e="";for(var o in t)e+=o+"="+t[o]+"&";return e.length>1?""+e.substring(0,e.length-1):e},t}();__reflect(HttpAPI.prototype,"HttpAPI");var core;!function(t){var e=function(t){function e(e,o){return t.call(this,e,o)||this}return __extends(e,t),e}(t.EventData);t.SocketEventData=e,__reflect(e.prototype,"core.SocketEventData")}(core||(core={}));var core;!function(t){var e=function(){function t(){}return t.init=function(){t._propertyChange=Object.create(null),t._anchorChange=Object.create(null),t.injectAnchor()},t.setAnchorX=function(t,e){t.anchorX=e},t.setAnchorY=function(t,e){t.anchorY=e},t.setAnchor=function(t,e){t.anchorX=t.anchorY=e},t.getAnchor=function(t){return t.anchorX!=t.anchorY&&console.log("target's anchorX != anchorY"),t.anchorX||0},t.getAnchorY=function(t){return t.anchorY||0},t.getAnchorX=function(t){return t.anchorX||0},t.injectAnchor=function(){Object.defineProperty(egret.DisplayObject.prototype,"width",{get:function(){return this.$getWidth()},set:function(e){var o=this;this.$setWidth(e),t._propertyChange[this.hashCode]=!0,egret.callLater(function(){t.changeAnchor(o)},this)},enumerable:!0,configurable:!0}),Object.defineProperty(egret.DisplayObject.prototype,"height",{get:function(){return this.$getHeight()},set:function(e){var o=this;this.$setHeight(e),t._propertyChange[this.hashCode]=!0,egret.callLater(function(){t.changeAnchor(o)},this)},enumerable:!0,configurable:!0}),Object.defineProperty(egret.DisplayObject.prototype,"anchorX",{get:function(){return this._anchorX},set:function(e){var o=this;this._anchorX=e,t._propertyChange[this.hashCode]=!0,t._anchorChange[this.hashCode]=!0,egret.callLater(function(){t.changeAnchor(o)},this)},enumerable:!0,configurable:!0}),Object.defineProperty(egret.DisplayObject.prototype,"anchorY",{get:function(){return this._anchorY},set:function(e){var o=this;this._anchorY=e,t._propertyChange[this.hashCode]=!0,t._anchorChange[this.hashCode]=!0,egret.callLater(function(){t.changeAnchor(o)},this)},enumerable:!0,configurable:!0})},t.changeAnchor=function(e){t._propertyChange[e.hashCode]&&t._anchorChange[e.hashCode]&&(e.anchorOffsetX=e._anchorX*e.width,e.anchorOffsetY=e._anchorY*e.height,delete t._propertyChange[e.hashCode])},t}();t.AnchorUtil=e,__reflect(e.prototype,"core.AnchorUtil")}(core||(core={}));var core;!function(t){var e=function(){function t(t){void 0===t&&(t=10),this.nums=[],this.numsLen=0,this.numSum=0,this.maxNum=t}return t.prototype.push=function(t){this.numsLen>this.maxNum&&(this.numsLen--,this.numSum-=this.nums.shift()),this.nums.push(t),this.numSum+=t,this.numsLen++},t.prototype.getValue=function(){return this.numSum/this.numsLen},t.prototype.clear=function(){this.nums.splice(0),this.numsLen=0,this.numSum=0},t}();t.AverageUtils=e,__reflect(e.prototype,"core.AverageUtils")}(core||(core={}));var core;!function(t){var e=function(){function t(){}return t.initEncodeChar=function(){for(var t=new Array(64),e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",o=0,r=e.length;r>o;o++)t[o]=e.charCodeAt(o);return t},t.initDecodeChar=function(){var t=[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,-1,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1];return t},t.encode=function(e){var o=new egret.ByteArray,r=0,n=e.length,i=n%3,s=n-i,a=0;for(e.position=0;s>r;)a=(255&e.readByte())<<16|(255&e.readByte())<<8|255&e.readByte(),o.writeByte(t.s_encodeChars[a>>>18]),o.writeByte(t.s_encodeChars[a>>>12&63]),o.writeByte(t.s_encodeChars[a>>>6&63]),o.writeByte(t.s_encodeChars[63&a]),r+=3;return 1==i?(a=255&e.readByte(),o.writeByte(t.s_encodeChars[a>>>2]),o.writeByte(t.s_encodeChars[3&a]),o.writeByte(61),o.writeByte(61)):2==i&&(a=(255&e.readByte())<<8|255&e.readByte(),o.writeByte(t.s_encodeChars[a>>>10]),o.writeByte(t.s_encodeChars[a>>>4&63]),o.writeByte(t.s_encodeChars[(15&a)<<2]),o.writeByte(61)),r+=i,o.position=0,o.readUTFBytes(o.length)},t.decode=function(e){var o=new egret.ByteArray,r=new egret.ByteArray;r.writeUTFBytes(e),r.position=0;for(var n,i,s,a,h=0,u=r.length;u>h&&(n=t.s_decodeChars[255&r.readByte()],-1!=n)&&(i=t.s_decodeChars[255&r.readByte()],-1!=i)&&(o.writeByte(n<<2|3&i),s=255&r.readByte(),61!=s)&&(s=t.s_decodeChars[s],-1!=s)&&(o.writeByte(240&i|15&s),a=255&r.readByte(),61!=a)&&(a=t.s_decodeChars[a],-1!=a);)o.writeByte(192&s|a),h+=4;return o.position=0,o},t.encodeStr=function(e){if(null!=e&&""!=e){var o=new egret.ByteArray;return o.writeUTFBytes(e),t.encode(o)}return""},t.decodeStr=function(e){if(null!=e&&""!=e){var o=t.decode(e);return o.readUTFBytes(o.length)}return""},t.s_encodeChars=t.initEncodeChar(),t.s_decodeChars=t.initDecodeChar(),t}();t.Base64=e,__reflect(e.prototype,"core.Base64")}(core||(core={}));var core;!function(t){var e=function(){function t(){}return t.addObj=function(e,o){if(e&&o){var r=t.s_pool[e];r?r.push(o):t.s_pool[e]=[o]}},t.getObj=function(e){var o=t.s_pool[e];return o?o.pop():null},t.clear=function(e){delete t.s_pool[e]},t.clearAll=function(){t.s_pool={}},t.s_pool={},t}();t.CachePool=e,__reflect(e.prototype,"core.CachePool")}(core||(core={}));var core;!function(t){var e=function(){function t(){}return t.calcuNetDelayStart=function(){t.s_sendTimestamp=egret.getTimer()},t.calcuNetDelayEnd=function(){t.s_delay=egret.getTimer()-t.s_sendTimestamp},t.getServerTime=function(){return Math.floor(.001*t.getServerTimeMill())},t.setServerTime=function(t){this.s_serverTimestamp=t,this.s_clientTimestamp=egret.getTimer()},t.getServerTimeMill=function(){return this.s_serverTimestamp+(egret.getTimer()-this.s_clientTimestamp)},t.getNetDelay=function(){return t.s_delay},t.getServerTimeYmd=function(){return Number(t.dateFormat("yyyyMMdd",t.getServerTime()))},t.dateFormat=function(t,e){var o=new Date(1e3*e),r={"M+":o.getMonth()+1,"d+":o.getDate(),"h+":o.getHours(),"m+":o.getMinutes(),"s+":o.getSeconds(),"q+":Math.floor((o.getMonth()+3)/3),S:o.getMilliseconds()};/(y+)/.test(t)&&(t=t.replace(RegExp.$1,(o.getFullYear()+"").substr(4-RegExp.$1.length)));for(var n in r)new RegExp("("+n+")").test(t)&&(t=t.replace(RegExp.$1,1==RegExp.$1.length?r[n]:("00"+r[n]).substr((""+r[n]).length)));return t},t.s_serverTimestamp=0,t.s_clientTimestamp=0,t.s_delay=10,t.s_sendTimestamp=0,t}();t.DateUtils=e,__reflect(e.prototype,"core.DateUtils")}(core||(core={}));var core;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e._threshold=3,e._startTimes={},e}return __extends(e,t),e.prototype.isOpen=function(t){this._isOpen=t},Object.defineProperty(e.prototype,"isDebug",{get:function(){return this._isOpen},enumerable:!0,configurable:!0}),e.prototype.start=function(t){this._isOpen&&(this._startTimes[t]=egret.getTimer())},e.prototype.stop=function(t){if(!this._isOpen)return 0;if(!this._startTimes[t])return 0;var e=egret.getTimer()-this._startTimes[t];return e>this._threshold&&Log.trace(t+": "+e),e},e.prototype.setThreshold=function(t){this._threshold=t},e}(t.BaseClass);t.DebugUtils=e,__reflect(e.prototype,"core.DebugUtils")}(core||(core={}));var core;!function(t){var e=function(t){function e(){return t.call(this)||this}return __extends(e,t),Object.defineProperty(e.prototype,"IsHtml5",{get:function(){return egret.Capabilities.runtimeType==egret.RuntimeType.WEB},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"IsNative",{get:function(){return egret.Capabilities.runtimeType==egret.RuntimeType.NATIVE},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"IsMobile",{get:function(){return egret.Capabilities.isMobile},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"IsPC",{get:function(){return!egret.Capabilities.isMobile},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"IsQQBrowser",{get:function(){return this.IsHtml5&&-1!=navigator.userAgent.indexOf("MQQBrowser")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"IsIEBrowser",{get:function(){return this.IsHtml5&&-1!=navigator.userAgent.indexOf("MSIE")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"IsFirefoxBrowser",{get:function(){return this.IsHtml5&&-1!=navigator.userAgent.indexOf("Firefox")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"IsChromeBrowser",{get:function(){return this.IsHtml5&&-1!=navigator.userAgent.indexOf("Chrome")
},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"IsSafariBrowser",{get:function(){return this.IsHtml5&&-1!=navigator.userAgent.indexOf("Safari")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"IsOperaBrowser",{get:function(){return this.IsHtml5&&-1!=navigator.userAgent.indexOf("Opera")},enumerable:!0,configurable:!0}),e}(t.BaseClass);t.DeviceUtils=e,__reflect(e.prototype,"core.DeviceUtils")}(core||(core={}));var core;!function(t){var e=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.createBitmap=function(t){var e=new egret.Bitmap,o=RES.getRes(t);return e.texture=o,e},e.prototype.removeFromParent=function(t){null!=t.parent&&t.parent.removeChild(t)},e.prototype.addChildAbove=function(t,e){t.parent==e.parent&&t.parent.getChildIndex(t)<e.parent.getChildIndex(e)?e.parent.addChildAt(t,e.parent.getChildIndex(e)):e.parent.addChildAt(t,e.parent.getChildIndex(e)+1)},e.prototype.addChildBelow=function(t,e){t.parent==e.parent&&t.parent.getChildIndex(t)<e.parent.getChildIndex(e)?e.parent.addChildAt(t,e.parent.getChildIndex(e)-1):e.parent.addChildAt(t,e.parent.getChildIndex(e))},e}(t.BaseClass);t.DisplayUtil=e,__reflect(e.prototype,"core.DisplayUtil")}(core||(core={}));var core;!function(t){var e=function(e){function o(){return e.call(this)||this}return __extends(o,e),o.prototype.init=function(){t.AnchorUtil.init()},o}(t.BaseClass);t.EgretExpandUtils=e,__reflect(e.prototype,"core.EgretExpandUtils")}(core||(core={}));var core;!function(t){var e=function(){function t(){}return t.prototype.delayCall=function(t,e,o){this.func=e,this.thisObj=o,egret.callLater(function(){App.TimerManager.doFrame(t,1,this.listener_enterFrame,this)},this)},t.prototype.listener_enterFrame=function(){this.func.call(this.thisObj)},t}();t.FrameDelay=e,__reflect(e.prototype,"core.FrameDelay")}(core||(core={}));var core;!function(t){var e=function(){function e(e){this.delayFrame=e,this.frameDelay=new t.FrameDelay,this.functions=new Array}return e.prototype.regist=function(t,e){this.functions.push([t,e])},e.prototype.execute=function(){if(this.functions.length){var t=this.functions.shift();t[0].call(t[1]),this.frameDelay.delayCall(this.delayFrame,this.execute,this)}},e}();t.FrameExecutor=e,__reflect(e.prototype,"core.FrameExecutor")}(core||(core={}));var core;!function(t){var e=function(){function t(t,e,o,r){void 0===t&&(t=null),void 0===e&&(e=null),void 0===o&&(o=null),void 0===r&&(r=!1),this.once=!1,this._id=0,this.setTo(t,e,o,r)}return t.prototype.setTo=function(e,o,r,n){return this._id=t._gid++,this.caller=e,this.method=o,this.args=r,this.once=n,this},t.prototype.run=function(){if(null==this.method)return null;var t=this._id,e=this.method.apply(this.caller,this.args);return this._id===t&&this.once&&this.recover(),e},t.prototype.runWith=function(t){if(null==this.method)return null;var e,o=this._id;return e=null==t?this.method.apply(this.caller,this.args):this.args||t.unshift?this.args?this.method.apply(this.caller,this.args.concat(t)):this.method.apply(this.caller,t):this.method.call(this.caller,t),this._id===o&&this.once&&this.recover(),e},t.prototype.clear=function(){return this.caller=null,this.method=null,this.args=null,this},t.prototype.recover=function(){this._id>0&&(this._id=0,t._pool.push(this.clear()))},t.create=function(e,o,r,n){return void 0===r&&(r=null),void 0===n&&(n=!0),t._pool.length?t._pool.pop().setTo(e,o,r,n):new t(e,o,r,n)},t._pool=[],t._gid=1,t}();t.Handler=e,__reflect(e.prototype,"core.Handler")}(core||(core={}));var Log=function(){function t(){}return t.trace=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];App.DebugUtils.isDebug&&(t[0]="[DebugLog]"+t[0],console.log.apply(console,t))},t}();__reflect(Log.prototype,"Log");var Long=function(){function t(t,e,o){this.__isLong__={value:!0,enumerable:!1,configurable:!1},this.low=0|t,this.high=0|e,this.unsigned=!!o}return t.prototype.isLong=function(t){return(t&&t.__isLong__)===!0},t.prototype.toInt=function(){return this.unsigned?this.low>>>0:this.low},t.prototype.toNumber=function(){return this.unsigned?(this.high>>>0)*t.TWO_PWR_32_DBL+(this.low>>>0):this.high*t.TWO_PWR_32_DBL+(this.low>>>0)},t.prototype.toString=function(e){if(e=e||10,2>e||e>36)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative()){if(this.eq(t.MIN_VALUE)){var o=t.fromNumber(e),r=this.div(o),n=r.mul(o).sub(this);return r.toString(e)+n.toInt().toString(e)}return"-"+this.neg().toString(e)}for(var i=t.fromNumber(t.pow_dbl(e,6),this.unsigned),s=this,a="";;){var h=s.div(i),u=s.sub(h.mul(i)).toInt()>>>0,c=u.toString(e);if(s=h,s.isZero())return c+a;for(;c.length<6;)c="0"+c;a=""+c+a}},Object.defineProperty(t.prototype,"highBitsUnsigned",{get:function(){return this.high>>>0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"lowBitsUnsigned",{get:function(){return this.low>>>0},enumerable:!0,configurable:!0}),t.prototype.getNumBitsAbs=function(){if(this.isNegative())return this.eq(t.MIN_VALUE)?64:this.neg().getNumBitsAbs();for(var e=0!=this.high?this.high:this.low,o=31;o>0&&0==(e&1<<o);o--);return 0!=this.high?o+33:o+1},t.prototype.isZero=function(){return 0===this.high&&0===this.low},t.prototype.isNegative=function(){return!this.unsigned&&this.high<0},t.prototype.isPositive=function(){return this.unsigned||this.high>=0},t.prototype.isOdd=function(){return 1===(1&this.low)},t.prototype.isEven=function(){return 0===(1&this.low)},t.prototype.eq=function(e){return this.isLong(e)||(e=t.fromValue(e)),this.unsigned!==e.unsigned&&this.high>>>31===1&&e.high>>>31===1?!1:this.high===e.high&&this.low===e.low},t.prototype.neq=function(t){return!this.eq(t)},t.prototype.lt=function(t){return this.compare(t)<0},t.prototype.lte=function(t){return this.compare(t)<=0},t.prototype.gt=function(t){return this.compare(t)>0},t.prototype.gte=function(t){return this.compare(t)>=0},t.prototype.compare=function(e){if(this.isLong(e)||(e=t.fromValue(e)),this.eq(e))return 0;var o=this.isNegative(),r=e.isNegative();return o&&!r?-1:!o&&r?1:this.unsigned?e.high>>>0>this.high>>>0||e.high===this.high&&e.low>>>0>this.low>>>0?-1:1:this.sub(e).isNegative()?-1:1},t.prototype.neg=function(){return!this.unsigned&&this.eq(t.MIN_VALUE)?t.MIN_VALUE:this.not().add(t.ONE)},t.prototype.add=function(e){this.isLong(e)||(e=t.fromValue(e));var o=this.high>>>16,r=65535&this.high,n=this.low>>>16,i=65535&this.low,s=e.high>>>16,a=65535&e.high,h=e.low>>>16,u=65535&e.low,c=0,l=0,p=0,d=0;return d+=i+u,p+=d>>>16,d&=65535,p+=n+h,l+=p>>>16,p&=65535,l+=r+a,c+=l>>>16,l&=65535,c+=o+s,c&=65535,t.fromBits(p<<16|d,c<<16|l,this.unsigned)},t.prototype.sub=function(e){return this.isLong(e)||(e=t.fromValue(e)),this.add(e.neg())},t.prototype.mul=function(e){if(this.isZero())return t.ZERO;if(this.isLong(e)||(e=t.fromValue(e)),e.isZero())return t.ZERO;if(this.eq(t.MIN_VALUE))return e.isOdd()?t.MIN_VALUE:t.ZERO;if(e.eq(t.MIN_VALUE))return this.isOdd()?t.MIN_VALUE:t.ZERO;if(this.isNegative())return e.isNegative()?this.neg().mul(e.neg()):this.neg().mul(e).neg();if(e.isNegative())return this.mul(e.neg()).neg();if(this.lt(t.TWO_PWR_24)&&e.lt(t.TWO_PWR_24))return t.fromNumber(this.toNumber()*e.toNumber(),this.unsigned);var o=this.high>>>16,r=65535&this.high,n=this.low>>>16,i=65535&this.low,s=e.high>>>16,a=65535&e.high,h=e.low>>>16,u=65535&e.low,c=0,l=0,p=0,d=0;return d+=i*u,p+=d>>>16,d&=65535,p+=n*u,l+=p>>>16,p&=65535,p+=i*h,l+=p>>>16,p&=65535,l+=r*u,c+=l>>>16,l&=65535,l+=n*h,c+=l>>>16,l&=65535,l+=i*a,c+=l>>>16,l&=65535,c+=o*u+r*h+n*a+i*s,c&=65535,t.fromBits(p<<16|d,c<<16|l,this.unsigned)},t.prototype.div=function(e){if(this.isLong(e)||(e=t.fromValue(e)),e.isZero())throw Error("division by zero");if(this.isZero())return this.unsigned?t.UZERO:t.ZERO;var o,r,n;if(this.unsigned){if(e.unsigned||(e=e.toUnsigned()),e.gt(this))return t.UZERO;if(e.gt(this.shru(1)))return t.UONE;n=t.UZERO}else{if(this.eq(t.MIN_VALUE)){if(e.eq(t.ONE)||e.eq(t.NEG_ONE))return t.MIN_VALUE;if(e.eq(t.MIN_VALUE))return t.ONE;var i=this.shr(1);return o=i.div(e).shl(1),o.eq(t.ZERO)?e.isNegative()?t.ONE:t.NEG_ONE:(r=this.sub(e.mul(o)),n=o.add(r.div(e)))}if(e.eq(t.MIN_VALUE))return this.unsigned?t.UZERO:t.ZERO;if(this.isNegative())return e.isNegative()?this.neg().div(e.neg()):this.neg().div(e).neg();if(e.isNegative())return this.div(e.neg()).neg();n=t.ZERO}for(r=this;r.gte(e);){o=Math.max(1,Math.floor(r.toNumber()/e.toNumber()));for(var s=Math.ceil(Math.log(o)/Math.LN2),a=48>=s?1:t.pow_dbl(2,s-48),h=t.fromNumber(o),u=h.mul(e);u.isNegative()||u.gt(r);)o-=a,h=t.fromNumber(o,this.unsigned),u=h.mul(e);h.isZero()&&(h=t.ONE),n=n.add(h),r=r.sub(u)}return n},t.prototype.mod=function(e){return this.isLong(e)||(e=t.fromValue(e)),this.sub(this.div(e).mul(e))},t.prototype.not=function(){return t.fromBits(~this.low,~this.high,this.unsigned)},t.prototype.and=function(e){return this.isLong(e)||(e=t.fromValue(e)),t.fromBits(this.low&e.low,this.high&e.high,this.unsigned)},t.prototype.or=function(e){return this.isLong(e)||(e=t.fromValue(e)),t.fromBits(this.low|e.low,this.high|e.high,this.unsigned)},t.prototype.xor=function(e){return this.isLong(e)||(e=t.fromValue(e)),t.fromBits(this.low^e.low,this.high^e.high,this.unsigned)},t.prototype.shl=function(e){return this.isLong(e)&&(e=e.toInt()),0===(e&=63)?this:32>e?t.fromBits(this.low<<e,this.high<<e|this.low>>>32-e,this.unsigned):t.fromBits(0,this.low<<e-32,this.unsigned)},t.prototype.shr=function(e){return this.isLong(e)&&(e=e.toInt()),0===(e&=63)?this:32>e?t.fromBits(this.low>>>e|this.high<<32-e,this.high>>e,this.unsigned):t.fromBits(this.high>>e-32,this.high>=0?0:-1,this.unsigned)},t.prototype.shru=function(e){if(this.isLong(e)&&(e=e.toInt()),e&=63,0===e)return this;var o=this.high;if(32>e){var r=this.low;return t.fromBits(r>>>e|o<<32-e,o>>>e,this.unsigned)}return 32===e?t.fromBits(o,0,this.unsigned):t.fromBits(o>>>e-32,0,this.unsigned)},t.prototype.toSigned=function(){return this.unsigned?t.fromBits(this.low,this.high,!1):this},t.prototype.toUnsigned=function(){return this.unsigned?this:t.fromBits(this.low,this.high,!0)},t.prototype.toBytesLE=function(){var t=this.high,e=this.low;return[255&e,e>>>8&255,e>>>16&255,e>>>24&255,255&t,t>>>8&255,t>>>16&255,t>>>24&255]},t.prototype.toBytesBE=function(){var t=this.high,e=this.low;return[t>>>24&255,t>>>16&255,t>>>8&255,255&t,e>>>24&255,e>>>16&255,e>>>8&255,255&e]},t.fromInt=function(e,o){var r,n,i;return o?(e>>>=0,(i=e>=0&&256>e)&&(n=t.UINT_CACHE[e])?n:(r=t.fromBits(e,0>(0|e)?-1:0,!0),i&&(t.UINT_CACHE[e]=r),r)):(e|=0,(i=e>=-128&&128>e)&&(n=t.INT_CACHE[e])?n:(r=t.fromBits(e,0>e?-1:0,!1),i&&(t.INT_CACHE[e]=r),r))},t.fromNumber=function(e,o){if(isNaN(e)||!isFinite(e))return o?t.UZERO:t.ZERO;if(o){if(0>e)return t.UZERO;if(e>=t.TWO_PWR_64_DBL)return t.MAX_UNSIGNED_VALUE}else{if(e<=-t.TWO_PWR_63_DBL)return t.MIN_VALUE;if(e+1>=t.TWO_PWR_63_DBL)return t.MAX_VALUE}return 0>e?t.fromNumber(-e,o).neg():t.fromBits(e%t.TWO_PWR_32_DBL|0,e/t.TWO_PWR_32_DBL|0,o)},t.fromBits=function(e,o,r){return new t(e,o,r)},t.fromString=function(e,o,r){if(0===e.length)throw Error("empty string");if("NaN"===e||"Infinity"===e||"+Infinity"===e||"-Infinity"===e)return t.ZERO;if("number"==typeof o?(r=o,o=!1):o=!!o,r=r||10,2>r||r>36)throw RangeError("radix");var n;if((n=e.indexOf("-"))>0)throw Error("interior hyphen");if(0===n)return t.fromString(e.substring(1),o,r).neg();for(var i=t.fromNumber(t.pow_dbl(r,8)),s=t.ZERO,a=0;a<e.length;a+=8){var h=Math.min(8,e.length-a),u=parseInt(e.substring(a,a+h),r);if(8>h){var c=t.fromNumber(t.pow_dbl(r,h));s=s.mul(c).add(t.fromNumber(u))}else s=s.mul(i),s=s.add(t.fromNumber(u))}return s.unsigned=o,s},t.fromValue=function(e){return e instanceof t?e:"number"==typeof e?t.fromNumber(e):"string"==typeof e?t.fromString(e):t.fromBits(e.low,e.high,e.unsigned)},t.INT_CACHE={},t.UINT_CACHE={},t.TWO_PWR_16_DBL=65536,t.TWO_PWR_24_DBL=1<<24,t.TWO_PWR_32_DBL=t.TWO_PWR_16_DBL*t.TWO_PWR_16_DBL,t.TWO_PWR_64_DBL=t.TWO_PWR_32_DBL*t.TWO_PWR_32_DBL,t.TWO_PWR_63_DBL=t.TWO_PWR_64_DBL/2,t.TWO_PWR_24=t.fromInt(t.TWO_PWR_24_DBL),t.ZERO=t.fromInt(0),t.UZERO=t.fromInt(0,!0),t.ONE=t.fromInt(1),t.UONE=t.fromInt(1,!0),t.NEG_ONE=t.fromInt(-1),t.MAX_VALUE=t.fromBits(-1,2147483647,!1),t.MAX_UNSIGNED_VALUE=t.fromBits(-1,-1,!0),t.MIN_VALUE=t.fromBits(0,-2147483648,!1),t.pow_dbl=Math.pow,t}();__reflect(Long.prototype,"Long");var core;!function(t){var e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.ceil=function(t){return t%1==0?t:t>0?t+1<<0:t<<0},e.prototype.random=function(t,e){return Math.random()*(e-t+1)+t<<0},e.prototype.getAngle=function(t){return 180*t/Math.PI},e.prototype.getRadian=function(t){return t/180*Math.PI},e.prototype.getRadian2=function(t,e,o,r){var n=o-t,i=r-e;return Math.atan2(i,n)},e.prototype.getDistance=function(t,e,o,r){var n=o-t,i=r-e,s=n*n+i*i;return Math.sqrt(s)},e.prototype.getSum=function(t,e){for(var o=0,r=t;e>=r;r++)o+=r;return o},e}(t.BaseClass);t.MathUtils=e,__reflect(e.prototype,"core.MathUtils")}(core||(core={}));var core;!function(t){var e=function(){function t(){this.m_factorys=new Dictionary,this.m_mcFactorys=new Dictionary}return t.prototype.getMovieClip=function(t,e,o){void 0===o&&(o=!0);var r=t+">"+e,n=this.m_factorys.get(r);if(n||(n=[],this.m_factorys.add(r,n)),n.length>0){var i=n.pop();return i}var s=this.m_mcFactorys.get(t);if(!s){var a=RES.getRes(t+"_json"),h=RES.getRes(t+"_png");if(!a||!h)return null;s=new egret.MovieClipDataFactory(a,h),s.enableCache=!0,this.m_mcFactorys.add(t,s)}var u=s.generateMovieClipData(e);if(u.mcData){var i=new egret.MovieClip(u);return i.gotoAndStop(1),i.key=r,o&&(i.anchorOffsetX=.5*(i.width+2*u.mcData.frames[0].x),i.anchorOffsetY=.5*(i.height+2*u.mcData.frames[0].y)),i}return null},t.prototype.revertMovieClip=function(t){if(t){var e=t.key;t.parent&&t.parent.removeChild(t);var o=this.m_factorys.get(e);o||(o=[],this.m_factorys.add(e,o)),o.push(t)}},Object.defineProperty(t,"instance",{get:function(){return null==t.s_instance&&(t.s_instance=new t),t.s_instance},enumerable:!0,configurable:!0}),t}();t.MCFactory=e,__reflect(e.prototype,"core.MCFactory")}(core||(core={}));var md5=function(){function t(){this.hexcase=0,this.b64pad=""}return t.prototype.hex_md5=function(t){return this.rstr2hex(this.rstr_md5(this.str2rstr_utf8(t)))},t.prototype.b64_md5=function(t){return this.rstr2b64(this.rstr_md5(this.str2rstr_utf8(t)))},t.prototype.any_md5=function(t,e){return this.rstr2any(this.rstr_md5(this.str2rstr_utf8(t)),e)},t.prototype.hex_hmac_md5=function(t,e){return this.rstr2hex(this.rstr_hmac_md5(this.str2rstr_utf8(t),this.str2rstr_utf8(e)))},t.prototype.b64_hmac_md5=function(t,e){return this.rstr2b64(this.rstr_hmac_md5(this.str2rstr_utf8(t),this.str2rstr_utf8(e)))},t.prototype.any_hmac_md5=function(t,e,o){return this.rstr2any(this.rstr_hmac_md5(this.str2rstr_utf8(t),this.str2rstr_utf8(e)),o)},t.prototype.md5_vm_test=function(){return"900150983cd24fb0d6963f7d28e17f72"==this.hex_md5("abc").toLowerCase()},t.prototype.rstr_md5=function(t){return this.binl2rstr(this.binl_md5(this.rstr2binl(t),8*t.length))},t.prototype.rstr_hmac_md5=function(t,e){var o=this.rstr2binl(t);o.length>16&&(o=this.binl_md5(o,8*t.length));for(var r=Array(16),n=Array(16),i=0;16>i;i++)r[i]=909522486^o[i],n[i]=1549556828^o[i];var s=this.binl_md5(r.concat(this.rstr2binl(e)),512+8*e.length);return this.binl2rstr(this.binl_md5(n.concat(s),640))},t.prototype.rstr2hex=function(t){try{this.hexcase}catch(e){this.hexcase=0}for(var o,r=this.hexcase?"0123456789ABCDEF":"0123456789abcdef",n="",i=0;i<t.length;i++)o=t.charCodeAt(i),n+=r.charAt(o>>>4&15)+r.charAt(15&o);return n},t.prototype.rstr2b64=function(t){try{this.b64pad}catch(e){this.b64pad=""}for(var o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",r="",n=t.length,i=0;n>i;i+=3)for(var s=t.charCodeAt(i)<<16|(n>i+1?t.charCodeAt(i+1)<<8:0)|(n>i+2?t.charCodeAt(i+2):0),a=0;4>a;a++)r+=8*i+6*a>8*t.length?this.b64pad:o.charAt(s>>>6*(3-a)&63);return r},t.prototype.rstr2any=function(t,e){var o,r,n,i,s,a=e.length,h=Array(Math.ceil(t.length/2));for(o=0;o<h.length;o++)h[o]=t.charCodeAt(2*o)<<8|t.charCodeAt(2*o+1);var u=Math.ceil(8*t.length/(Math.log(e.length)/Math.log(2))),c=Array(u);for(r=0;u>r;r++){for(s=Array(),i=0,o=0;o<h.length;o++)i=(i<<16)+h[o],n=Math.floor(i/a),i-=n*a,(s.length>0||n>0)&&(s[s.length]=n);c[r]=i,h=s}var l="";for(o=c.length-1;o>=0;o--)l+=e.charAt(c[o]);return l},t.prototype.str2rstr_utf8=function(t){for(var e,o,r="",n=-1;++n<t.length;)e=t.charCodeAt(n),o=n+1<t.length?t.charCodeAt(n+1):0,e>=55296&&56319>=e&&o>=56320&&57343>=o&&(e=65536+((1023&e)<<10)+(1023&o),n++),127>=e?r+=String.fromCharCode(e):2047>=e?r+=String.fromCharCode(192|e>>>6&31,128|63&e):65535>=e?r+=String.fromCharCode(224|e>>>12&15,128|e>>>6&63,128|63&e):2097151>=e&&(r+=String.fromCharCode(240|e>>>18&7,128|e>>>12&63,128|e>>>6&63,128|63&e));return r},t.prototype.str2rstr_utf16le=function(t){for(var e="",o=0;o<t.length;o++)e+=String.fromCharCode(255&t.charCodeAt(o),t.charCodeAt(o)>>>8&255);return e},t.prototype.str2rstr_utf16be=function(t){for(var e="",o=0;o<t.length;o++)e+=String.fromCharCode(t.charCodeAt(o)>>>8&255,255&t.charCodeAt(o));return e},t.prototype.rstr2binl=function(t){for(var e=Array(t.length>>2),o=0;o<e.length;o++)e[o]=0;for(var o=0;o<8*t.length;o+=8)e[o>>5]|=(255&t.charCodeAt(o/8))<<o%32;return e},t.prototype.binl2rstr=function(t){for(var e="",o=0;o<32*t.length;o+=8)e+=String.fromCharCode(t[o>>5]>>>o%32&255);return e},t.prototype.binl_md5=function(t,e){t[e>>5]|=128<<e%32,t[(e+64>>>9<<4)+14]=e;for(var o=1732584193,r=-271733879,n=-1732584194,i=271733878,s=0;s<t.length;s+=16){var a=o,h=r,u=n,c=i;o=this.md5_ff(o,r,n,i,t[s+0],7,-680876936),i=this.md5_ff(i,o,r,n,t[s+1],12,-389564586),n=this.md5_ff(n,i,o,r,t[s+2],17,606105819),r=this.md5_ff(r,n,i,o,t[s+3],22,-1044525330),o=this.md5_ff(o,r,n,i,t[s+4],7,-176418897),i=this.md5_ff(i,o,r,n,t[s+5],12,1200080426),n=this.md5_ff(n,i,o,r,t[s+6],17,-1473231341),r=this.md5_ff(r,n,i,o,t[s+7],22,-45705983),o=this.md5_ff(o,r,n,i,t[s+8],7,1770035416),i=this.md5_ff(i,o,r,n,t[s+9],12,-1958414417),n=this.md5_ff(n,i,o,r,t[s+10],17,-42063),r=this.md5_ff(r,n,i,o,t[s+11],22,-1990404162),o=this.md5_ff(o,r,n,i,t[s+12],7,1804603682),i=this.md5_ff(i,o,r,n,t[s+13],12,-40341101),n=this.md5_ff(n,i,o,r,t[s+14],17,-1502002290),r=this.md5_ff(r,n,i,o,t[s+15],22,1236535329),o=this.md5_gg(o,r,n,i,t[s+1],5,-165796510),i=this.md5_gg(i,o,r,n,t[s+6],9,-1069501632),n=this.md5_gg(n,i,o,r,t[s+11],14,643717713),r=this.md5_gg(r,n,i,o,t[s+0],20,-373897302),o=this.md5_gg(o,r,n,i,t[s+5],5,-701558691),i=this.md5_gg(i,o,r,n,t[s+10],9,38016083),n=this.md5_gg(n,i,o,r,t[s+15],14,-660478335),r=this.md5_gg(r,n,i,o,t[s+4],20,-405537848),o=this.md5_gg(o,r,n,i,t[s+9],5,568446438),i=this.md5_gg(i,o,r,n,t[s+14],9,-1019803690),n=this.md5_gg(n,i,o,r,t[s+3],14,-187363961),r=this.md5_gg(r,n,i,o,t[s+8],20,1163531501),o=this.md5_gg(o,r,n,i,t[s+13],5,-1444681467),i=this.md5_gg(i,o,r,n,t[s+2],9,-51403784),n=this.md5_gg(n,i,o,r,t[s+7],14,1735328473),r=this.md5_gg(r,n,i,o,t[s+12],20,-1926607734),o=this.md5_hh(o,r,n,i,t[s+5],4,-378558),i=this.md5_hh(i,o,r,n,t[s+8],11,-2022574463),n=this.md5_hh(n,i,o,r,t[s+11],16,1839030562),r=this.md5_hh(r,n,i,o,t[s+14],23,-35309556),o=this.md5_hh(o,r,n,i,t[s+1],4,-1530992060),i=this.md5_hh(i,o,r,n,t[s+4],11,1272893353),n=this.md5_hh(n,i,o,r,t[s+7],16,-155497632),r=this.md5_hh(r,n,i,o,t[s+10],23,-1094730640),o=this.md5_hh(o,r,n,i,t[s+13],4,681279174),i=this.md5_hh(i,o,r,n,t[s+0],11,-358537222),n=this.md5_hh(n,i,o,r,t[s+3],16,-722521979),r=this.md5_hh(r,n,i,o,t[s+6],23,76029189),o=this.md5_hh(o,r,n,i,t[s+9],4,-640364487),i=this.md5_hh(i,o,r,n,t[s+12],11,-421815835),n=this.md5_hh(n,i,o,r,t[s+15],16,530742520),r=this.md5_hh(r,n,i,o,t[s+2],23,-995338651),o=this.md5_ii(o,r,n,i,t[s+0],6,-198630844),i=this.md5_ii(i,o,r,n,t[s+7],10,1126891415),n=this.md5_ii(n,i,o,r,t[s+14],15,-1416354905),r=this.md5_ii(r,n,i,o,t[s+5],21,-57434055),o=this.md5_ii(o,r,n,i,t[s+12],6,1700485571),i=this.md5_ii(i,o,r,n,t[s+3],10,-1894986606),n=this.md5_ii(n,i,o,r,t[s+10],15,-1051523),r=this.md5_ii(r,n,i,o,t[s+1],21,-2054922799),o=this.md5_ii(o,r,n,i,t[s+8],6,1873313359),i=this.md5_ii(i,o,r,n,t[s+15],10,-30611744),n=this.md5_ii(n,i,o,r,t[s+6],15,-1560198380),r=this.md5_ii(r,n,i,o,t[s+13],21,1309151649),o=this.md5_ii(o,r,n,i,t[s+4],6,-145523070),i=this.md5_ii(i,o,r,n,t[s+11],10,-1120210379),n=this.md5_ii(n,i,o,r,t[s+2],15,718787259),r=this.md5_ii(r,n,i,o,t[s+9],21,-343485551),o=this.safe_add(o,a),r=this.safe_add(r,h),n=this.safe_add(n,u),i=this.safe_add(i,c)}return[o,r,n,i]},t.prototype.md5_cmn=function(t,e,o,r,n,i){return this.safe_add(this.bit_rol(this.safe_add(this.safe_add(e,t),this.safe_add(r,i)),n),o)},t.prototype.md5_ff=function(t,e,o,r,n,i,s){return this.md5_cmn(e&o|~e&r,t,e,n,i,s)},t.prototype.md5_gg=function(t,e,o,r,n,i,s){return this.md5_cmn(e&r|o&~r,t,e,n,i,s)},t.prototype.md5_hh=function(t,e,o,r,n,i,s){return this.md5_cmn(e^o^r,t,e,n,i,s)},t.prototype.md5_ii=function(t,e,o,r,n,i,s){return this.md5_cmn(o^(e|~r),t,e,n,i,s)},t.prototype.safe_add=function(t,e){var o=(65535&t)+(65535&e),r=(t>>16)+(e>>16)+(o>>16);return r<<16|65535&o},t.prototype.bit_rol=function(t,e){return t<<e|t>>>32-e},t}();__reflect(md5.prototype,"md5");var core;!function(t){var e=function(e){function o(t){var o=e.call(this)||this;return o.type=t,o.dict={},o.eVec=new Array,o.lastRunTime=0,0==o.type&&App.TimerManager.doFrame(1,0,o.run,o),o}return __extends(o,e),o.prototype.clear=function(){this.dict={},this.eVec.splice(0)},o.prototype.addListener=function(t,e,o){var r=this.dict[t];null==r&&(r=new Array,this.dict[t]=r);var n=0,i=r.length;for(n;i>n;n++)if(r[n][0]==e&&r[n][1]==o)return;r.push([e,o])},o.prototype.removeListener=function(t,e,o){var r=this.dict[t];if(null!=r){var n=0,i=r.length;for(n;i>n;n++)if(r[n][0]==e&&r[n][1]==o){r.splice(n,1);break}0==r.length&&(this.dict[t]=null,delete this.dict[t])}},o.prototype.removeAll=function(t){for(var e=Object.keys(this.dict),o=0,r=e.length;r>o;o++){for(var n=e[o],i=this.dict[n],s=0;s<i.length;s++)i[s][1]==t&&(i.splice(s,1),s--);0==i.length&&(this.dict[n]=null,delete this.dict[n])}},o.prototype.dispatch=function(e){for(var o=[],r=1;r<arguments.length;r++)o[r-1]=arguments[r];if(null!=this.dict[e]){var n=t.ObjectPool.pop("MessageVo");n.type=e,n.param=o,0==this.type?this.eVec.push(n):1==this.type?this.dealMsg(n):Log.trace("MessageCenter未实现的类型")}},o.prototype.run=function(){var t=egret.getTimer(),e=t-this.lastRunTime>100;if(this.lastRunTime=t,e)for(;this.eVec.length>0;)this.dealMsg(this.eVec.shift());else for(;this.eVec.length>0&&(this.dealMsg(this.eVec.shift()),!(egret.getTimer()-t>5)););},o.prototype.dealMsg=function(e){for(var o=this.dict[e.type],r=0,n=o.length,i=null;n>r;)i=o[r],i[0].apply(i[1],e.param),o.length!=n&&(n=o.length,r--),r++;e.dispose(),t.ObjectPool.push(e)},o}(t.BaseClass);t.MessageCenter=e,__reflect(e.prototype,"core.MessageCenter")}(core||(core={}));var MessageVo=function(){function t(){}return t.prototype.dispose=function(){this.type=null,this.param=null},t}();__reflect(MessageVo.prototype,"MessageVo");var core;!function(t){var e=function(){function t(){this._objs=new Array}return t.prototype.pushObj=function(t){this._objs.push(t)},t.prototype.popObj=function(){return this._objs.length>0?this._objs.pop():null},t.prototype.clear=function(){for(;this._objs.length>0;)this._objs.pop()},t.pop=function(e){for(var o=[],r=1;r<arguments.length;r++)o[r-1]=arguments[r];t._content[e]||(t._content[e]=[]);var n=t._content[e];if(n.length)return n.pop();var i,s=egret.getDefinitionByName(e),a=o.length;return 0==a?i=new s:1==a?i=new s(o[0]):2==a?i=new s(o[0],o[1]):3==a?i=new s(o[0],o[1],o[2]):4==a?i=new s(o[0],o[1],o[2],o[3]):5==a&&(i=new s(o[0],o[1],o[2],o[3],o[4])),i.ObjectPoolKey=e,i},t.popWithExtraKey=function(e,o){t._content[e]||(t._content[e]=[]);var r,n=t._content[e];if(n.length)for(var i=0;i<n.length;i++)if(n[i].extraKey==o){r=n[i],n.splice(i,1);break}if(!r){var s=egret.getDefinitionByName(e);r=new s(o),r.extraKey=o,r.ObjectPoolKey=e}return r},t.push=function(e){if(null==e)return!1;var o=e.ObjectPoolKey;return t._content[o]?(t._content[o].push(e),!0):!1},t.clear=function(){t._content={}},t.clearClass=function(e,o){void 0===o&&(o=null);for(var r=t._content[e];r&&r.length;){var n=r.pop();o&&n[o](),n=null}t._content[e]=null,delete t._content[e]},t.dealFunc=function(e,o){var r=t._content[e];if(null!=r){var n=0,i=r.length;for(n;i>n;n++)r[n][o]()}},t._content={},t}();t.ObjectPool=e,__reflect(e.prototype,"core.ObjectPool")}(core||(core={}));var core;!function(t){var e=function(){function t(){}return Object.defineProperty(t,"isPC",{get:function(){return"Windows PC"==egret.Capabilities.os},enumerable:!0,configurable:!0}),Object.defineProperty(t,"isiOS",{get:function(){return"iOS"==egret.Capabilities.os},enumerable:!0,configurable:!0}),Object.defineProperty(t,"isAndroid",{get:function(){return"Android"==egret.Capabilities.os},enumerable:!0,configurable:!0}),Object.defineProperty(t,"isWindowPhone",{get:function(){return"Windows Phone"==egret.Capabilities.os},enumerable:!0,configurable:!0}),Object.defineProperty(t,"isMacOS",{get:function(){return"Mac OS"==egret.Capabilities.os},enumerable:!0,configurable:!0}),Object.defineProperty(t,"isUnknown",{get:function(){return"Unknown"==egret.Capabilities.os},enumerable:!0,configurable:!0}),t}();t.PlatUtils=e,__reflect(e.prototype,"core.PlatUtils")}(core||(core={}));var core;!function(t){var e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.limit=function(t,e){t=Math.min(t,e),e=Math.max(t,e);var o=e-t;return t+Math.random()*o},e.prototype.limitInteger=function(t,e){return Math.round(this.limit(t,e))},e.prototype.randomArray=function(t){var e=Math.floor(Math.random()*t.length);return t[e]},e}(t.BaseClass);t.RandomUtils=e,__reflect(e.prototype,"core.RandomUtils")}(core||(core={}));var core;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e._groupIndex=0,e._configs=new Array,e._groups={},RES.addEventListener(RES.ResourceEvent.GROUP_COMPLETE,e.onResourceLoadComplete,e),RES.addEventListener(RES.ResourceEvent.GROUP_PROGRESS,e.onResourceLoadProgress,e),RES.addEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,e.onResourceLoadError,e),e}return __extends(e,t),e.prototype.addConfig=function(t,e){this._configs.push([t,e])},e.prototype.loadConfig=function(t,e){this._onConfigComplete=t,this._onConfigCompleteTarget=e,this.loadNextConfig()},e.prototype.loadNextConfig=function(){if(0==this._configs.length)return this._onConfigComplete.call(this._onConfigCompleteTarget),this._onConfigComplete=null,void(this._onConfigCompleteTarget=null);var t=this._configs.shift();RES.addEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigCompleteHandle,this),RES.loadConfig(t[0],t[1])},e.prototype.onConfigCompleteHandle=function(t){RES.removeEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigCompleteHandle,this),this.loadNextConfig()},e.prototype.loadGroup=function(t,e,o,r){this._groups[t]=[e,o,r],RES.loadGroup(t)},e.prototype.loadGroups=function(t,e,o,r,n){RES.createGroup(t,e,!0),this.loadGroup(t,o,r,n)},e.prototype.pilfererLoadGroup=function(t,e){void 0===e&&(e=null);var o="pilferer_"+t;e||(e=[t]),RES.createGroup(o,e,!0),RES.loadGroup(o,-1)},e.prototype.onResourceLoadComplete=function(t){var e=t.groupName;if(this._groups[e]){var o=this._groups[e][0],r=this._groups[e][2];null!=o&&o.apply(r,[e]),this._groups[e]=null,delete this._groups[e]}},e.prototype.onResourceLoadProgress=function(t){var e=t.groupName;if(this._groups[e]){var o=this._groups[e][1],r=this._groups[e][2];null!=o&&o.call(r,t.itemsLoaded,t.itemsTotal)}},e.prototype.onResourceLoadError=function(t){Log.trace(t.groupName+"资源组有资源加载失败"),this.onResourceLoadComplete(t)},e.prototype.loadResource=function(t,e,o,r,n){void 0===t&&(t=[]),void 0===e&&(e=[]),void 0===o&&(o=null),void 0===r&&(r=null),void 0===n&&(n=null);var i=t.concat(e),s="loadGroup"+this._groupIndex++;RES.createGroup(s,i,!0),this._groups[s]=[o,r,n],RES.loadGroup(s)},e.prototype.createGroup=function(t,e){RES.createGroup(t,e,!0)},e}(t.BaseClass);t.ResourceUtils=e,__reflect(e.prototype,"core.ResourceUtils")}(core||(core={}));var Main=function(t){function e(){var e=t.call(this)||this;return e.addEventListener(egret.Event.ADDED_TO_STAGE,e.onAddToStage,e),e}return __extends(e,t),e.prototype.onAddToStage=function(t){egret.lifecycle.addLifecycleListener(function(t){t.onUpdate=function(){}}),egret.lifecycle.onPause=function(){egret.ticker.pause()},egret.lifecycle.onResume=function(){egret.ticker.resume()},this.runGame()["catch"](function(t){console.log(t)})},e.prototype.runGame=function(){return __awaiter(this,void 0,void 0,function(){var t,e;return __generator(this,function(o){switch(o.label){case 0:return[4,this.loadResource()];case 1:return o.sent(),this.startEngine(),[4,RES.getResAsync("description_json")];case 2:return t=o.sent(),[4,platform.login()];case 3:return o.sent(),[4,platform.getUserInfo()];case 4:return e=o.sent(),console.log(e),[2]}})})},e.prototype.loadResource=function(){return __awaiter(this,void 0,void 0,function(){var t,e;return __generator(this,function(o){switch(o.label){case 0:return o.trys.push([0,4,,5]),t=new LoadingUI,this.stage.addChild(t),[4,RES.loadConfig("resource/default.res.json","resource/")];case 1:return o.sent(),[4,RES.loadGroup("preload",0,t)];case 2:return o.sent(),[4,RES.loadGroup("game",0,t)];case 3:return o.sent(),this.stage.removeChild(t),[3,5];case 4:return e=o.sent(),console.error(e),[3,5];case 5:return[2]}})})},e.prototype.startEngine=function(){App.StageUtils.startFullscreenAdaptation(640,960),LayerCenter.Instance.init(this.stage),App.run(this.stage),new RegModuleTask,new BindFGuiTask,new RegRunTimeClassTask,this.startGame()},e.prototype.startGame=function(){fairygui.UIPackage.addPackage("game"),ModuleMgr.ins.showModule(ModuleEnum.GAME_TOP,[]),ModuleMgr.ins.showModule(ModuleEnum.GAME,[])},e}(egret.DisplayObjectContainer);__reflect(Main.prototype,"Main");var core;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.MAP=0,e.SPRITE=1,e.mapPoss=[new egret.Point(0,3),new egret.Point(0,0),new egret.Point(0,-2)],e.spritePoss=[new egret.Point(5,0),new egret.Point(-5,0),new egret.Point(5,0)],e._shockLength=0,e._shockCount=0,e._rx=0,e._ry=0,e._type=0,e._repeatCount=0,e}return __extends(e,t),e.prototype.destroy=function(){this.stop()},e.prototype.shock=function(t,e,o){void 0===t&&(t=0),void 0===e&&(e=null),void 0===o&&(o=3),this._target||(this._type=t,this._target=e,this._type==this.MAP?(this._shockPoss=this.mapPoss.concat(),this._shockLength=this._shockPoss.length):this._type==this.SPRITE&&(this._shockPoss=this.spritePoss.concat(),this._shockLength=this._shockPoss.length),this.start(o))},e.prototype.start=function(t){void 0===t&&(t=1),this.repeatCount=t,this._shockCount=0,this._target&&(this._type!=this.MAP&&(this._rx=this._target.x),this._ry=this._target.y,App.TimerManager.doFrame(1,0,this.onShockEnter,this))},e.prototype.stop=function(){this._target&&(this._type!=this.MAP&&(this._target.x=this._rx),this._target.y=this._ry,App.TimerManager.remove(this.onShockEnter,this)),this._target=null},e.prototype.onShockEnter=function(t){var e=this._shockLength*this._repeatCount;if(this._shockCount>=e)return void this.stop();var o=this._shockCount%this._shockLength,r=this._shockPoss[o];this._target&&(this._type!=this.MAP&&(this._target.x=this._rx+r.x),this._target.y=this._ry+r.y),this._shockCount++},Object.defineProperty(e.prototype,"repeatCount",{get:function(){return this._repeatCount},set:function(t){this._repeatCount=t},enumerable:!0,configurable:!0}),e}(t.BaseClass);t.ShockUtils=e,__reflect(e.prototype,"core.ShockUtils")}(core||(core={}));var core;!function(t){var e=function(){function t(){this.m_BGMVolume=1,this.m_effectVolume=1,this.m_sounds={},this.m_channels={},this.m_callbacks={},this.m_playChannel={},this.m_soundGroups={},this.m_soundGroups[egret.Sound.EFFECT]=[],this.m_soundGroups[egret.Sound.MUSIC]=[];var t=egret.localStorage.getItem("soundEffect");
t&&(this.m_effectVolume=parseInt(t)),t=egret.localStorage.getItem("soundBGM"),t&&(this.m_BGMVolume=parseInt(t))}return t.prototype.playSound=function(t,e,o){void 0===e&&(e=1);var r;if(!r)return void egret.log("ID为"+t+"的音效在SoundConfig中不存在");this.stopSound(r.coverKey.toString());var n=this.m_sounds[t];if(n||(n=RES.getRes(r.soundName),n&&(n.type=0==r.soundType?egret.Sound.EFFECT:egret.Sound.MUSIC,this.m_sounds[t]=n,this.m_soundGroups[n.type].push(n))),!n)return void egret.log("名称为"+r.soundName+"的音效资源不存在");this.m_playChannel[r.coverKey.toString()]=n,n.cover=r.coverKey.toString();var i=void 0;try{i=n.play(0,e)}catch(s){return egret.log("ID为"+t+"的音乐播放失败"),void delete this.m_playChannel[r.coverKey.toString()]}i.owner=n,i.maxCount=e>0?e:Number.MAX_VALUE,i.count=0,n.type==egret.Sound.EFFECT?i.volume=this.m_effectVolume:i.volume=this.m_BGMVolume,o&&(this.m_callbacks[i.hashCode.toString()]=o),i.addEventListener(egret.Event.SOUND_COMPLETE,this.onPlayComplete,this),this.m_channels[n.hashCode.toString()]=i},t.prototype.onPlayComplete=function(t){var e=t.currentTarget,o=this.m_callbacks[e.hashCode.toString()];o&&o(),e.count++,e.count>=e.maxCount&&this.stop(e.owner)},t.prototype.stopSoundByID=function(t){var e=this.m_sounds[t];e&&this.stop(e)},t.prototype.stopSound=function(t){var e=this.m_playChannel[t];e&&this.stop(e)},t.prototype.stop=function(t){var e=this.m_channels[t.hashCode.toString()];if(e){try{e.stop()}catch(o){egret.log("停止播放音乐失败")}e.hasEventListener(egret.Event.SOUND_COMPLETE)&&e.removeEventListener(egret.Event.SOUND_COMPLETE,this.onPlayComplete,this),delete this.m_callbacks[e.hashCode.toString()],delete this.m_channels[t.hashCode.toString()]}delete this.m_playChannel[t.cover]},t.prototype.setBGMValume=function(t){egret.localStorage.setItem("soundBGM",t.toString()),this.m_BGMVolume=t;for(var e=this.m_soundGroups[egret.Sound.MUSIC],o=0,r=e.length;r>o;o++){var n=e[o];if(n){var i=this.m_channels[n.hashCode.toString()];if(i)try{i.volume=t}catch(s){egret.log("背景音乐音量设置失败")}}}},t.prototype.getBGMValue=function(){return this.m_BGMVolume},t.prototype.setEffectValume=function(t){egret.localStorage.setItem("soundEffect",t.toString()),this.m_effectVolume=t;for(var e=this.m_soundGroups[egret.Sound.EFFECT],o=0,r=e.length;r>o;o++){var n=e[o];if(n){var i=this.m_channels[n.hashCode.toString()];if(i)try{i.volume=t}catch(s){egret.log("音效音量设置失败")}}}},t.prototype.getEffectValue=function(){return this.m_effectVolume},t.getInstance=function(){return null==t.s_instance&&(t.s_instance=new t),t.s_instance},t}();t.SoundUtils=e,__reflect(e.prototype,"core.SoundUtils")}(core||(core={}));var core;!function(t){var e=function(t){function e(){var o=t.call(this)||this;return null==e._uiStage&&(e._uiStage=LayerCenter.Instance),o}return __extends(e,t),e.prototype.getHeight=function(){return this.getStage().stageHeight},e.prototype.getWidth=function(){return this.getStage().stageWidth},e.prototype.setTouchChildren=function(t){this.getStage().touchChildren=t},e.prototype.setMaxTouches=function(t){this.getStage().maxTouches=t},e.prototype.setFrameRate=function(t){this.getStage().frameRate=t},e.prototype.setScaleMode=function(t){this.getStage().scaleMode=t},e.prototype.getStage=function(){return egret.MainContext.instance.stage},e.prototype.getUIStage=function(){return e._uiStage},e.prototype.startFullscreenAdaptation=function(t,e){this.designWidth=t,this.designHeight=e,this.getStage().setContentSize(t,e)},e.prototype.stageOnResize=function(){this.getStage().removeEventListener(egret.Event.RESIZE,this.stageOnResize,this);var t=this.designWidth,e=this.designHeight,o=window.innerWidth,r=window.innerHeight,n=o/r,i=t/e,s=n/i;if(n>i){var a=s,h=s;t=Math.floor(t*a),e=Math.floor(e*h)}this.getStage().setContentSize(t,e),App.EventCenter.dispatch(egret.Event.RESIZE),this.getStage().addEventListener(egret.Event.RESIZE,this.stageOnResize,this)},e}(t.BaseClass);t.StageUtils=e,__reflect(e.prototype,"core.StageUtils")}(core||(core={}));var core;!function(t){var e=function(){function e(){}return e.createTextfield=function(t,e,o,r,n){void 0===e&&(e=16777215),void 0===o&&(o=egret.VerticalAlign.MIDDLE),void 0===r&&(r=egret.HorizontalAlign.CENTER),void 0===n&&(n="Verdana");var i=new egret.TextField;return i.size=t,i.textColor=e,i.textAlign=r,i.verticalAlign=o,i.fontFamily=n,i.cacheAsBitmap=!0,i},e.formatString=function(t,e){if(t){for(var o=/\{[0-9]+?\}/;t.match(o);){var r=t.match(o),n=r[0].match(/[0-9]+?/);t=t.replace(o,e[parseInt(n[0])])}return t}return""},e.parseHtmlText=function(t){return e.s_textFlowParser.parse(t)},e.showTextTip=function(e,o){void 0===o&&(o=16777215);var r=LayerCenter.stageWidth,n=LayerCenter.stageHeight,i=t.TextUtils.createTextfield(30);i.text=e,i.textColor=o,i.width=i.textWidth,i.height=i.textHeight,i.x=.5*(r-i.width),i.y=.5*(n-i.height),LayerCenter.Instance.stage.addChild(i),egret.Tween.get(i).to({y:.4*n,alpha:0},1e3,egret.Ease.circIn).call(function(t){t.parent.removeChild(t)},this,[i])},e.s_textFlowParser=new egret.HtmlTextParser,e}();t.TextUtils=e,__reflect(e.prototype,"core.TextUtils")}(core||(core={}));var core;!function(t){var e=function(e){function o(){var t=e.call(this)||this;return t._handlers=new Array,t._delHandlers=new Array,t._currTime=egret.getTimer(),t._currFrame=0,t._count=0,t._timeScale=1,egret.Ticker.getInstance().register(t.onEnterFrame,t),t}return __extends(o,e),o.prototype.setTimeScale=function(t){this._timeScale=t},o.prototype.onEnterFrame=function(){this._currFrame++,this._currTime=egret.getTimer(),App.DebugUtils.start("TimerManager:");for(var t=0;t<this._count;t++){var e=this._handlers[t],o=e.userFrame?this._currFrame:this._currTime;o>=e.exeTime&&(App.DebugUtils.start(e.method.toString()),e.method.call(e.methodObj,(this._currTime-e.dealTime)*this._timeScale),App.DebugUtils.stop(e.method.toString()),e.dealTime=this._currTime,e.exeTime+=e.delay,e.repeat||(e.repeatCount>1?e.repeatCount--:(e.complateMethod&&e.complateMethod.apply(e.complateMethodObj),this._delHandlers.push(e))))}for(;this._delHandlers.length;){var e=this._delHandlers.pop();this.remove(e.method,e.methodObj)}App.DebugUtils.stop("TimerManager:")},o.prototype.create=function(e,o,r,n,i,s,a){if(!(0>o||0>r||null==n)){this.remove(n,i);var h=t.ObjectPool.pop("TimerHandler");h.userFrame=e,h.repeat=0==r,h.repeatCount=r,h.delay=o,h.method=n,h.methodObj=i,h.complateMethod=s,h.complateMethodObj=a,h.exeTime=o+(e?this._currFrame:this._currTime),h.dealTime=this._currTime,this._handlers.push(h),this._count++}},o.prototype.doTimer=function(t,e,o,r,n,i){void 0===n&&(n=null),void 0===i&&(i=null),this.create(!1,t,e,o,r,n,i)},o.prototype.doFrame=function(t,e,o,r,n,i){void 0===n&&(n=null),void 0===i&&(i=null),this.create(!0,t,e,o,r,n,i)},Object.defineProperty(o.prototype,"count",{get:function(){return this._count},enumerable:!0,configurable:!0}),o.prototype.remove=function(e,o){for(var r=0;r<this._count;r++){var n=this._handlers[r];if(n.method==e&&n.methodObj==o){this._handlers.splice(r,1),t.ObjectPool.push(n),this._count--;break}}},o.prototype.removeAll=function(e){for(var o=0;o<this._count;o++){var r=this._handlers[o];r.methodObj==e&&(this._handlers.splice(o,1),t.ObjectPool.push(r),this._count--,o--)}},o.prototype.isExists=function(t,e){for(var o=0;o<this._count;o++){var r=this._handlers[o];if(r.method==t&&r.methodObj==e)return!0}return!1},o}(t.BaseClass);t.TimerManager=e,__reflect(e.prototype,"core.TimerManager")}(core||(core={}));var TimerHandler=function(){function t(){this.delay=0,this.repeatCount=0,this.exeTime=0,this.dealTime=0}return t.prototype.clear=function(){this.method=null,this.methodObj=null,this.complateMethod=null,this.complateMethodObj=null},t}();__reflect(TimerHandler.prototype,"TimerHandler");var core;!function(t){var e=function(){function t(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this._x=t,this._y=e}return t.prototype.draw=function(t,e){void 0===e&&(e=0),t.lineStyle(0,e),t.moveTo(0,0),t.lineTo(this._x,this._y)},t.prototype.clone=function(){return new t(this.x,this.y)},t.prototype.zero=function(){return this._x=0,this._y=0,this},t.prototype.isZero=function(){return 0==this._x&&0==this._y},Object.defineProperty(t.prototype,"length",{get:function(){return Math.sqrt(this.lengthSQ)},set:function(t){var e=this.angle;this._x=Math.cos(e)*t,this._y=Math.sin(e)*t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"lengthSQ",{get:function(){return this._x*this._x+this._y*this._y},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"angle",{get:function(){return Math.atan2(this._y,this._x)},set:function(t){var e=this.length;this._x=Math.cos(t)*e,this._y=Math.sin(t)*e},enumerable:!0,configurable:!0}),t.prototype.normalize=function(){if(0==this.length)return this._x=1,this;var t=this.length;return this._x/=t,this._y/=t,this},t.prototype.truncate=function(t){return this.length=Math.min(t,this.length),this},t.prototype.reverse=function(){return this._x=-this._x,this._y=-this._y,this},t.prototype.isNormalized=function(){return 1==this.length},t.prototype.dotProd=function(t){return this._x*t.x+this._y*t.y},t.prototype.crossProd=function(t){return this._x*t.y-this._y*t.x},t.angleBetween=function(t,e){return t.isNormalized()||(t=t.clone().normalize()),e.isNormalized()||(e=e.clone().normalize()),Math.acos(t.dotProd(e))},t.prototype.sign=function(t){return this.perp.dotProd(t)<0?-1:1},Object.defineProperty(t.prototype,"perp",{get:function(){return new t(-this.y,this.x)},enumerable:!0,configurable:!0}),t.prototype.dist=function(t){return Math.sqrt(this.distSQ(t))},t.prototype.distSQ=function(t){var e=t.x-this.x,o=t.y-this.y;return e*e+o*o},t.prototype.add=function(e){return new t(this._x+e.x,this._y+e.y)},t.prototype.subtract=function(e){return new t(this._x-e.x,this._y-e.y)},t.prototype.multiply=function(e){return new t(this._x*e,this._y*e)},t.prototype.divide=function(e){return new t(this._x/e,this._y/e)},t.prototype.equals=function(t){return this._x==t.x&&this._y==t.y},Object.defineProperty(t.prototype,"x",{get:function(){return this._x},set:function(t){this._x=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"y",{get:function(){return this._y},set:function(t){this._y=t},enumerable:!0,configurable:!0}),t.prototype.tostring=function(){return"[Vector2D (x:"+this._x+", y:"+this._y+")]"},t}();t.Vector2D=e,__reflect(e.prototype,"core.Vector2D")}(core||(core={}));var core;!function(t){var e=function(){function e(){}return e.addKeyboardListener=function(){document.onkeydown=function(o){o&&e.isKeyboard&&App.EventCenter.dispatch(t.EventID.KEYBOARD_DOWN,o)},document.onkeyup=function(o){o&&e.isKeyboard&&App.EventCenter.dispatch(t.EventID.KEYBOARD_UP,o)}},e.isKeyboard=!0,e}();t.WebUtils=e,__reflect(e.prototype,"core.WebUtils")}(core||(core={}));var core;!function(t){var e=function(){function t(){}return t}();t.XMLUtils=e,__reflect(e.prototype,"core.XMLUtils")}(core||(core={}));var BoxFactory=function(){function t(){}return t.createPuzzleBox=function(){var t=0,e=0,o={1:50,2:50,3:60,4:40,5:30,6:60,7:50,8:30,9:30,10:20,11:60};for(var r in o)e+=Number(o[r]);var n=App.MathUtils.random(0,e-1);for(var r in o)if(n-=o[r],0>n){t=Number(r);break}var i=App.MathUtils.random(1,GameConsts.GAME_BOX_COLOR_NUM),s=new Box(t,i);return s},t.createSingleBox=function(t,e){var o=core.ObjectPool.pop(t,e);return o.x=0,o.y=0,o.scaleX=o.scaleY=1,o.alpha=1,o},t.data={1:50,2:50,3:60,4:40,5:30,6:60,7:50,8:30,9:30,10:20,11:60},t}();__reflect(BoxFactory.prototype,"BoxFactory");var FloatScore=function(t){function e(){return t.call(this)||this}return __extends(e,t),Object.defineProperty(e.prototype,"data",{set:function(t){this.m_txt_score.text=t.toString(),this.m_showmovie.play(this.playComplete,this)},enumerable:!0,configurable:!0}),e.prototype.playComplete=function(){Utils.floatScore(this,new egret.Point(340,75))},e}(game.UI_FloatScore);__reflect(FloatScore.prototype,"FloatScore");var Game=function(t){function e(){var e=t.call(this)||this;return e.clickarea1=new egret.Bitmap,e.clickarea2=new egret.Bitmap,e.clickarea3=new egret.Bitmap,e.nowMoveRaw=-1,e.nowMoveColumn=-1,e.dropAble=!1,e.gameover=!1,e.touchCon=0,e.scale=1,e.touchStatus=!1,e._distance=new egret.Point,e}return __extends(e,t),e.prototype.initContent=function(){this.content=new fairygui.GComponent},Object.defineProperty(e.prototype,"mContent",{get:function(){return this.content},enumerable:!0,configurable:!0}),e.prototype.preShow=function(e){t.prototype.preShow.call(this,e);var o=Utils.createBitmapByName("gamebg");o.width=App.StageUtils.getWidth(),o.height=App.StageUtils.getHeight(),this.mContent.displayListContainer.addChild(o),this.map=new Map,this.map.x=GameConsts.GAME_PADDING,this.map.y=GameConsts.GAME_PADDING_TOP,App.StageUtils.getHeight()-this.map.y-this.map.height<GameConsts.GAME_CLICK_AREA&&(this.map.y=App.StageUtils.getHeight()-GameConsts.GAME_CLICK_AREA-this.map.height),this.mContent.displayListContainer.addChild(this.map),App.EventCenter.addListener("gameover",this.reStartGame,this),this.createClickBox(1),this.createClickBox(2),this.createClickBox(3),this.createStartThreeBox(),this.floatScore=FloatScore.createInstance(),this.mContent.displayListContainer.addChild(this.floatScore.displayObject),this.floatScore.visible=!1,this.mContent.displayListContainer.setChildIndex(this.floatScore.displayObject,this.mContent.displayListContainer.numChildren-1)},e.prototype.reStartGame=function(){GameModel.ins.restart(),this.touchStatus=!1,this.nowMoveRaw=-1,this.nowMoveColumn=-1,this.dropAble=!1,this.gameover=!1,this.map.dispose();for(var t=0;t<this.boxAry.length;t++){var e=this.boxAry[t];e.dispose();var o=App.MathUtils.random(1,GameConsts.GAME_BOX_TYPE_NUM),r=App.MathUtils.random(1,GameConsts.GAME_BOX_COLOR_NUM);e.type=o,e.color=r,e.create(),e.x=-GameConsts.GAME_CLICK_AREA/2+(GameConsts.GAME_CLICK_AREA+10)*e.pos-(e.style_w/2-.5)*GameConsts.GAME_TILE_WIDHT_AND_HEIGHT*.4,e.y=App.StageUtils.getStage().stageHeight-GameConsts.GAME_CLICK_AREA/2-(e.style_h/2-.5)*GameConsts.GAME_TILE_WIDHT_AND_HEIGHT*.4}this.box=null},e.prototype.createStartThreeBox=function(){this.boxAry=[];for(var t=1;4>t;t++){var e=BoxFactory.createPuzzleBox();e.pos=t,e.x=-GameConsts.GAME_CLICK_AREA/2+(GameConsts.GAME_CLICK_AREA+10)*e.pos-(e.style_w/2-.5)*GameConsts.GAME_TILE_WIDHT_AND_HEIGHT*.4,e.y=App.StageUtils.getStage().stageHeight-GameConsts.GAME_CLICK_AREA/2-(e.style_h/2-.5)*GameConsts.GAME_TILE_WIDHT_AND_HEIGHT*.4,this.mContent.displayListContainer.addChild(e),this.boxAry.push(e)}},e.prototype.addBox=function(){for(var t=0;t<this.boxAry.length;t++)this.boxAry[t]!=this.box&&this.boxAry[t].pos>this.box.pos&&(this.boxAry[t].pos-=1);if(null!=this.box){this.box.dispose();var e=App.MathUtils.random(1,11),o=App.MathUtils.random(1,4);this.box.type=e,this.box.color=o,this.box.create(),this.box.pos=3,this.box.x=GameConsts.GAME_BOX_INIT_NEW,this.box.y=App.StageUtils.getStage().stageHeight,this.box.alpha=0}for(var t=0;t<this.boxAry.length;t++)egret.Tween.get(this.boxAry[t]).to({x:-GameConsts.GAME_CLICK_AREA/2+(GameConsts.GAME_CLICK_AREA+10)*this.boxAry[t].pos-(this.boxAry[t].style_w/2-.5)*GameConsts.GAME_TILE_WIDHT_AND_HEIGHT*.4,y:App.StageUtils.getStage().stageHeight-GameConsts.GAME_CLICK_AREA/2-(this.boxAry[t].style_h/2-.5)*GameConsts.GAME_TILE_WIDHT_AND_HEIGHT*.4,alpha:1},400)},e.prototype.startDrag=function(t){this.touchCon++,this.touchCon>1||1!=this.gameover&&(this.box=this.getClickBox(t.target),this.touchStatus=!0,egret.Tween.get(this.box).to({x:-GameConsts.GAME_CLICK_AREA/2+(GameConsts.GAME_CLICK_AREA+10)*this.box.pos-(this.box.style_w/2-.5)*GameConsts.GAME_TILE_WIDHT_AND_HEIGHT,y:this.map.y+this.map.height-this.box.style_h*GameConsts.GAME_TILE_WIDHT_AND_HEIGHT},50),this._distance.x=t.stageX-(-GameConsts.GAME_CLICK_AREA/2+(GameConsts.GAME_CLICK_AREA+10)*this.box.pos-(this.box.style_w/2-.5)*GameConsts.GAME_TILE_WIDHT_AND_HEIGHT),this._distance.y=t.stageY-(this.map.y+this.map.height-this.box.style_h*GameConsts.GAME_TILE_WIDHT_AND_HEIGHT),egret.setTimeout(this.box.doScale,this.box,30))},e.prototype.getClickBox=function(t){var e;switch(t){case this.clickarea1:e=1;break;case this.clickarea2:e=2;break;case this.clickarea3:e=3}for(var o=0;o<this.boxAry.length;o++)if(this.boxAry[o].pos==e)return this.boxAry[o]},e.prototype.mouseMove=function(t){if(this.touchStatus){this.box.x=t.stageX-this._distance.x,this.box.y=t.stageY-this._distance.y;var e=this.map.globalToLocal(this.box.x,this.box.y),o=Math.floor(e.x/GameConsts.GAME_TILE_WIDHT_AND_HEIGHT),r=Math.floor(e.y/GameConsts.GAME_TILE_WIDHT_AND_HEIGHT);(this.nowMoveRaw!=r||this.nowMoveColumn!=o)&&(this.nowMoveRaw=r,this.nowMoveColumn=o,this.map.clearTemporary(),r<GameConsts.GAME_TILE_ROW&&o<GameConsts.GAME_TILE_COLUMN&&r>-1&&o>-1?this.dropAble=this.map.checkPos(r,o,this.box.style,this.box.color):this.dropAble=!1)}},e.prototype.doDrop=function(t){if(this.touchCon=0,null!=this.box&&1!=this.gameover&&0!=this.touchStatus)if(this.touchStatus=!1,0==this.dropAble)this.map.clearTemporary(),egret.Tween.get(this.box).to({x:-GameConsts.GAME_CLICK_AREA/2+(GameConsts.GAME_CLICK_AREA+10)*this.box.pos-(this.box.style_w/2-.5)*GameConsts.GAME_TILE_WIDHT_AND_HEIGHT*.4,y:App.StageUtils.getStage().stageHeight-GameConsts.GAME_CLICK_AREA/2-(this.box.style_h/2-.5)*GameConsts.GAME_TILE_WIDHT_AND_HEIGHT*.4},100),this.box.doNormal();else{this.dropAble=!1;var e=this.map.getTileByRawAndColumn(this.nowMoveRaw,this.nowMoveColumn),o=this.map.localToGlobal(e.x,e.y);egret.Tween.get(this.box).to({x:o.x,y:o.y},50).call(this.onDropDown,this),this.box.doDrop()}},e.prototype.onDropDown=function(){this.dropEndPos=new egret.Point(this.box.x,this.box.y),this.map.addOfficial(this.nowMoveRaw,this.nowMoveColumn,this.box.style,this.box.color),this.nowMoveRaw=-1,this.nowMoveColumn=-1,egret.setTimeout(this.checkDrop,this,50),this.dropAble=!1},e.prototype.checkDrop=function(){var t=this.map.checkLine(),e=0;if(t[2]>0){var o=10*App.MathUtils.getSum(0,t[2]);this.floatScore.visible=!0,this.mContent.displayListContainer.setChildIndex(this.floatScore.displayObject,this.mContent.displayListContainer.numChildren-1),this.floatScore.x=t[0]-this.floatScore.width/2,this.floatScore.y=t[1]-this.floatScore.height/2,this.floatScore.data=o,e=GameModel.ins.nowScore+o,GameModel.ins.scoreSign=e,t[2]>2&&App.ShockUtils.shock(1,this.mContent.displayObject,5)}else e=GameModel.ins.nowScore+this.box.score,GameModel.ins.score=e;this.addBox();for(var r=!1,n=0;n<this.boxAry.length;n++)if(1==this.map.checkCanGoOn(this.boxAry[n])){r=!0;break}0==r&&(this.gameover=!0,egret.setTimeout(this.gameOver,this,1e3))},e.prototype.gameOver=function(){this.gameover=!0,ModuleMgr.ins.showModule(ModuleEnum.GameOver,[])},e.prototype.createClickBox=function(t){var e=GameConsts.GAME_CLICK_AREA,o=GameConsts.GAME_CLICK_AREA-30;this["clickarea"+t]=Utils.createFairyGuiBitmapByName("red"),this["clickarea"+t].width=e,this["clickarea"+t].height=o,this["clickarea"+t].anchorOffsetX=e/2,this["clickarea"+t].anchorOffsetY=o/2,this["clickarea"+t].alpha=0,this["clickarea"+t].touchEnabled=!0,this["clickarea"+t].x=-e/2+(e+10)*t,this["clickarea"+t].y=App.StageUtils.getStage().stageHeight-GameConsts.GAME_CLICK_AREA/2,this["clickarea"+t].addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.startDrag,this),App.StageUtils.getStage().addEventListener(egret.TouchEvent.TOUCH_END,this.doDrop,this),App.StageUtils.getStage().addEventListener(egret.TouchEvent.TOUCH_MOVE,this.mouseMove,this),this.mContent.displayListContainer.addChild(this["clickarea"+t])},e}(Module);__reflect(Game.prototype,"Game");var GameConsts=function(){function t(){}return t.GAME_TILE_ROW=9,t.GAME_TILE_COLUMN=9,t.GAME_PADDING=21,t.GAME_KUANG_SIDE=11,t.GAME_TILE_WIDHT_AND_HEIGHT=64,t.GAME_PADDING_TOP=170,t.GAME_CLICK_AREA=200,t.GAME_BOX_INIT1=80,t.GAME_BOX_INIT2=300,t.GAME_BOX_INIT3=500,t.GAME_BOX_INIT_NEW=600,t.GAME_BOX_COLOR_NUM=5,t.GAME_BOX_TYPE_NUM=11,t}();__reflect(GameConsts.prototype,"GameConsts");var GameModel=function(){function t(){this.nowScore=0,this.maxScore=0,this.scoreSign=0}return Object.defineProperty(t,"ins",{get:function(){return null==t.s_instance&&(t.s_instance=new t),t.s_instance},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"score",{get:function(){return this.nowScore},set:function(t){this.nowScore=t,this.nowScore>this.maxScore&&(this.maxScore=this.nowScore,egret.localStorage.setItem("puzzleBox_maxScore",this.maxScore.toString())),App.EventCenter.dispatch("nowscorechange")},enumerable:!0,configurable:!0}),t.prototype.restart=function(){this.nowScore=0},t}();__reflect(GameModel.prototype,"GameModel");var GameOverModule=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initContent=function(){this.content=game.UI_GameOverPanel.createInstance()},Object.defineProperty(e.prototype,"mContent",{get:function(){return this.content},enumerable:!0,configurable:!0}),e.prototype.preShow=function(t){this.mContent.m_btn_restart.addClickListener(function(){App.EventCenter.dispatch("gameover"),ModuleMgr.ins.closeModule(ModuleEnum.GameOver)},this),this.mContent.m_txt_now.text=GameModel.ins.score.toString(),this.mContent.m_txt_max.text=GameModel.ins.maxScore.toString(),this.preShowCpl()},e.prototype.show=function(e){t.prototype.show.call(this,e)},e}(PopModuleView);__reflect(GameOverModule.prototype,"GameOverModule");var GameTop=function(t){function e(){var e=t.call(this)||this;return e.Cont={val:0},e}return __extends(e,t),e.prototype.initContent=function(){this.content=game.UI_TopUI.createInstance()},Object.defineProperty(e.prototype,"mContent",{get:function(){return this.content},enumerable:!0,configurable:!0}),e.prototype.preShow=function(t){this.mContent.m_btn_pause.addClickListener(function(){ModuleMgr.ins.showModule(ModuleEnum.GameOver)},this),App.EventCenter.addListener("nowscorechange",this.changeNowScore,this),App.EventCenter.addListener("gameover",this.gameRestart,this),GameModel.ins.maxScore=Number(egret.localStorage.getItem("puzzleBox_maxScore")),this.preShowCpl()},e.prototype.changeNowScore=function(){var t=12,e=1;GameModel.ins.nowScore-this.Cont.val>30?(t=8,e=3):GameModel.ins.nowScore-this.Cont.val>60&&(t=4,e=8),this.interval=egret.setInterval(this.onChange,this,t,e)},e.prototype.onChange=function(t){this.Cont.val+t>GameModel.ins.nowScore?this.Cont.val=GameModel.ins.nowScore:this.Cont.val+=t,this.Cont.val>=GameModel.ins.nowScore&&egret.clearInterval(this.interval),this.mContent.m_txt_score.text=Number(this.Cont.val).toString()},e.prototype.gameRestart=function(){this.mContent.m_txt_score.text="0",this.Cont.val=0},e}(Module);__reflect(GameTop.prototype,"GameTop");var Map=function(t){function e(){var e=t.call(this)||this;return e.tileDic=new Dictionary,e.createTile(),e}return __extends(e,t),e.prototype.createTile=function(){var t=Utils.createBitmapByName("kuang");this.addChild(t);for(var e=0;e<GameConsts.GAME_TILE_ROW;e++)for(var o=0;o<GameConsts.GAME_TILE_COLUMN;o++){var r=new Tile(e,o);this.addChild(r),r.x=GameConsts.GAME_KUANG_SIDE+GameConsts.GAME_TILE_WIDHT_AND_HEIGHT/2+GameConsts.GAME_TILE_WIDHT_AND_HEIGHT*o,r.y=GameConsts.GAME_KUANG_SIDE+GameConsts.GAME_TILE_WIDHT_AND_HEIGHT/2+GameConsts.GAME_TILE_WIDHT_AND_HEIGHT*e,this.tileDic.add(e+"_"+o,r)}},e.prototype.checkLine=function(){for(var t=[],e=[],o=0;o<GameConsts.GAME_TILE_ROW;o++){for(var r=!0,n=0;n<GameConsts.GAME_TILE_COLUMN;n++)if(1==this.getTileByRawAndColumn(o,n).isEmpty){r=!1;break}r&&t.push(o)}for(var o=0;o<GameConsts.GAME_TILE_COLUMN;o++){for(var i=!0,n=0;n<GameConsts.GAME_TILE_ROW;n++)if(1==this.getTileByRawAndColumn(n,o).isEmpty){i=!1;break}i&&e.push(o)}for(var o=0;o<t.length;o++)for(var n=0;n<GameConsts.GAME_TILE_COLUMN;n++)0==this.getTileByRawAndColumn(t[o],n).isEmpty&&this.getTileByRawAndColumn(t[o],n).doDipsear();for(var o=0;o<e.length;o++)for(var n=0;n<GameConsts.GAME_TILE_ROW;n++)0==this.getTileByRawAndColumn(n,e[o]).isEmpty&&this.getTileByRawAndColumn(n,e[o]).doDipsear();for(var s,a,h=0,o=0;o<t.length;o++)h+=Number(t[o]+1);a=h>0?this.y+h/t.length*GameConsts.GAME_TILE_WIDHT_AND_HEIGHT:this.y+GameConsts.GAME_TILE_ROW/2*GameConsts.GAME_TILE_WIDHT_AND_HEIGHT;for(var u=0,o=0;o<e.length;o++)u+=Number(e[o]+1);return s=u>0?this.x+u/e.length*GameConsts.GAME_TILE_WIDHT_AND_HEIGHT:this.x+GameConsts.GAME_TILE_COLUMN/2*GameConsts.GAME_TILE_WIDHT_AND_HEIGHT,[s,a,e.length+t.length]},e.prototype.checkPos=function(t,e,o,r){for(var n=0;n<o.length;n++)for(var i=0;i<o[n].length;i++)if(1==o[n][i]){var s=this.tileDic.get(t+n+"_"+(e+i));if(null==s)return!1;if(0==s.isEmpty)return!1}for(var n=0;n<o.length;n++)for(var i=0;i<o[n].length;i++)1==o[n][i]&&1==this.tileDic.get(t+n+"_"+(e+i)).isEmpty&&this.tileDic.get(t+n+"_"+(e+i)).addTemporary(r);return this.checkLineTemporary(t,e,o,r),!0},e.prototype.checkLineTemporary=function(t,e,o,r){for(var n=[],i=[],s=0;s<o.length;s++){for(var a=!0,h=0;h<GameConsts.GAME_TILE_COLUMN;h++)if(1==this.getTileByRawAndColumn(t+s,h).isEmpty&&0==this.getTileByRawAndColumn(t+s,h).isTemporary){a=!1;break}1==a&&n.push(t+s)}for(var s=0;s<o[0].length;s++){for(var u=!0,h=0;h<GameConsts.GAME_TILE_ROW;h++)if(1==this.getTileByRawAndColumn(h,e+s).isEmpty&&0==this.getTileByRawAndColumn(h,e+s).isTemporary){u=!1;break}1==u&&i.push(e+s)}if(n.length>0)for(var s=0;s<n.length;s++)for(var h=0;h<GameConsts.GAME_TILE_COLUMN;h++)this.tileDic.get(n[s]+"_"+h).addTemporary(r);if(i.length>0)for(var s=0;s<i.length;s++)for(var h=0;h<GameConsts.GAME_TILE_ROW;h++)this.tileDic.get(h+"_"+i[s]).addTemporary(r);return!0},e.prototype.clearTemporary=function(){for(var t=this.tileDic.values.length,e=0;t>e;e++)this.tileDic.values[e].clearTemporary()},e.prototype.getTileByRawAndColumn=function(t,e){return this.tileDic.get(t+"_"+e)},e.prototype.addOfficial=function(t,e,o,r){for(var n=0;n<o.length;n++)for(var i=0;i<o[n].length;i++)1==o[n][i]&&1==this.tileDic.get(t+n+"_"+(e+i)).isEmpty&&this.tileDic.get(t+n+"_"+(e+i)).addOfficial(r)},e.prototype.checkCanGoOn=function(t){for(var e=!1,o=0;o<GameConsts.GAME_TILE_ROW;o++)for(var r=0;r<GameConsts.GAME_TILE_COLUMN;r++)if(1==this.getTileByRawAndColumn(o,r).isEmpty){for(var n=!0,i=o,s=r,a=0;a<t.style.length;a++)for(var h=0;h<t.style[a].length;h++)if(1==t.style[a][h]){var u=this.tileDic.get(i+a+"_"+(s+h));null==u?n=!1:0==u.isEmpty&&(n=!1)}1==n&&(e=!0)}return e},e.prototype.dispose=function(){for(var t=this.tileDic.values.length,e=0;t>e;e++)this.tileDic.values[e].dispose()},e}(egret.DisplayObjectContainer);__reflect(Map.prototype,"Map");var Box=function(t){function e(e,o){var r=t.call(this)||this;return r.style=[[1,1,1,1,1]],r.style_w=0,r.style_h=0,r.score=0,r.weight=50,r.boxSingleAry=[],r.type=e,r.color=o,r.create(),r}return __extends(e,t),e.prototype.create=function(){switch(this.type){case 1:this.style=[[1]],this.style_w=1,this.style_h=1,this.weight=50;break;case 2:this.style=[[1],[1]],this.style_w=1,this.style_h=2,this.weight=50;break;case 3:this.style=[[1,1,1]],this.style_w=3,this.style_h=1,this.weight=60;break;case 4:this.style=[[1,1],[1,0]],this.style_w=2,this.style_h=2,this.weight=40;break;case 5:this.style=[[1,1],[1,1]],this.style_w=2,this.style_h=2,this.weight=30;break;case 6:this.style=[[1,0],[1,0],[1,1]],this.style_w=2,this.style_h=3,this.weight=60;break;case 7:this.style=[[1],[1],[1],[1]],this.style_w=1,this.style_h=4,this.weight=50;break;case 8:this.style=[[1],[1],[1],[1],[1]],this.style_w=1,this.style_h=5,this.weight=30;break;case 9:this.style=[[1,0,0],[1,0,0],[1,1,1]],this.style_w=3,this.style_h=3,this.weight=30;break;case 10:this.style=[[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1]],this.style_w=4,this.style_h=4,this.weight=20;break;case 11:this.style=[[1,1,0],[0,1,1]],this.style_w=3,this.style_h=2,this.weight=60}for(var t=0;t<this.style.length;t++)for(var e=0;e<this.style[t].length;e++)if(0!=this.style[t][e]){var o="BoxSingleRed";switch(this.color){case 1:o="BoxSingleRed";break;case 2:o="BoxSingleYellow";break;case 3:o="BoxSingleBlue";break;case 4:o="BoxSingleGreen";break;case 5:o="BoxSinglePurple"}var r=BoxFactory.createSingleBox(o,this.color);r.setPosXY(t,e),r.scaleX=r.scaleY=.4,r.x=.4*GameConsts.GAME_TILE_WIDHT_AND_HEIGHT*e,r.y=.4*GameConsts.GAME_TILE_WIDHT_AND_HEIGHT*t,this.addChild(r),this.boxSingleAry.push(r),this.score+=1}},e.prototype.doScale=function(){for(var t=this.boxSingleAry.length,e=0;t>e;e++){var o=this.boxSingleAry[e];egret.Tween.get(o).to({scaleX:.9,scaleY:.9,x:o.posy*(1*GameConsts.GAME_TILE_WIDHT_AND_HEIGHT),y:o.posx*(1*GameConsts.GAME_TILE_WIDHT_AND_HEIGHT)},50)}},e.prototype.doNormal=function(){for(var t=this.boxSingleAry.length,e=0;t>e;e++){var o=this.boxSingleAry[e];egret.Tween.get(o).to({scaleX:.4,scaleY:.4,x:o.posy*(.4*GameConsts.GAME_TILE_WIDHT_AND_HEIGHT),y:o.posx*(.4*GameConsts.GAME_TILE_WIDHT_AND_HEIGHT)},100)}},e.prototype.doDrop=function(){for(var t=this.boxSingleAry.length,e=0;t>e;e++){var o=this.boxSingleAry[e];egret.Tween.get(o).to({scaleX:1,scaleY:1,x:o.posy*(1*GameConsts.GAME_TILE_WIDHT_AND_HEIGHT),y:o.posx*(1*GameConsts.GAME_TILE_WIDHT_AND_HEIGHT)},40)}},e.prototype.setGray=function(){new egret.Filter;this.filters=[new egret.Filter]},e.prototype.dispose=function(){for(var t=this.boxSingleAry.length,e=0;t>e;e++){var o=this.boxSingleAry[e];null!=o.parent&&o.parent.removeChild(o),core.ObjectPool.push(o),o=null}this.score=0,this.boxSingleAry=[]},e}(egret.DisplayObjectContainer);__reflect(Box.prototype,"Box");var LoadingUI=function(t){function e(){var e=t.call(this)||this;return e.createView(),e}return __extends(e,t),e.prototype.createView=function(){this.textField=new egret.TextField,this.addChild(this.textField),this.textField.y=300,this.textField.width=480,this.textField.height=100,this.textField.textAlign="center"},e.prototype.onProgress=function(t,e){this.textField.text="Loading..."+t+"/"+e},e}(egret.Sprite);__reflect(LoadingUI.prototype,"LoadingUI",["RES.PromiseTaskReporter"]);var BoxSingleBlue=function(t){function e(e){return t.call(this,e)||this}return __extends(e,t),e}(BoxSingle);__reflect(BoxSingleBlue.prototype,"BoxSingleBlue");var BoxSingleGreen=function(t){function e(e){return t.call(this,e)||this}return __extends(e,t),e}(BoxSingle);__reflect(BoxSingleGreen.prototype,"BoxSingleGreen");var BoxSinglePurple=function(t){function e(e){return t.call(this,e)||this}return __extends(e,t),e}(BoxSingle);__reflect(BoxSinglePurple.prototype,"BoxSinglePurple");var BoxSingleRed=function(t){function e(e){return t.call(this,e)||this}return __extends(e,t),e}(BoxSingle);__reflect(BoxSingleRed.prototype,"BoxSingleRed");var BoxSingleYellow=function(t){function e(e){return t.call(this,e)||this}return __extends(e,t),e}(BoxSingle);__reflect(BoxSingleYellow.prototype,"BoxSingleYellow");var Tile=function(t){function e(e,o){var r=t.call(this)||this;return r.isEmpty=!0,r.isTemporary=!1,r.row=e,r.column=o,r.createNormal(),r}return __extends(e,t),e.prototype.createNormal=function(){this.bg=Utils.createFairyGuiBitmapByName("tile_bg"),this.bg.width=GameConsts.GAME_TILE_WIDHT_AND_HEIGHT,this.bg.height=GameConsts.GAME_TILE_WIDHT_AND_HEIGHT,this.bg.anchorOffsetX=GameConsts.GAME_TILE_WIDHT_AND_HEIGHT/2,this.bg.anchorOffsetY=GameConsts.GAME_TILE_WIDHT_AND_HEIGHT/2,this.addChild(this.bg)},e.prototype.addTemporary=function(t){1!=this.isTemporary&&(this.isTemporary=!0,this.temporaryBox=this.createBox(t),this.temporaryBox.scaleX=this.temporaryBox.scaleY=.9,this.temporaryBox.alpha=.5,this.addChild(this.temporaryBox),null!=this.officalBox&&(this.officalBox.alpha=0))},e.prototype.clearTemporary=function(){null!=this.temporaryBox&&(this.temporaryBox.parent&&this.temporaryBox.parent.removeChild(this.temporaryBox),core.ObjectPool.push(this.temporaryBox),this.temporaryBox=null),this.isTemporary=!1,null!=this.officalBox&&(this.officalBox.alpha=1)},e.prototype.addOfficial=function(t){this.clearTemporary(),this.isEmpty=!1,this.color=t,this.officalBox=this.createBox(t),this.addChild(this.officalBox)},e.prototype.doDipsear=function(){this.clearTemporary(),this.isEmpty=!0,egret.Tween.get(this.officalBox).to({scaleX:0,scaleY:0},200).call(this.dispose,this)},e.prototype.dispose=function(){this.isEmpty=!0,null!=this.officalBox&&(null!=this.officalBox.parent&&this.officalBox.parent.removeChild(this.officalBox),core.ObjectPool.push(this.officalBox),this.officalBox=null)
},e.prototype.createBox=function(t){var e;switch(t){case 1:e="BoxSingleRed";break;case 2:e="BoxSingleYellow";break;case 3:e="BoxSingleBlue";break;case 4:e="BoxSingleGreen";break;case 5:e="BoxSinglePurple"}var o=BoxFactory.createSingleBox(e,t);return o},e}(egret.DisplayObjectContainer);__reflect(Tile.prototype,"Tile");var game;!function(t){var e=function(){function e(){}return e.bindAll=function(){fairygui.UIObjectFactory.setPackageItemExtension(t.UI_GameOverPanel.URL,t.UI_GameOverPanel),fairygui.UIObjectFactory.setPackageItemExtension(t.UI_BtnRestart.URL,t.UI_BtnRestart),fairygui.UIObjectFactory.setPackageItemExtension(t.UI_TopUI.URL,t.UI_TopUI),fairygui.UIObjectFactory.setPackageItemExtension(t.UI_FloatScore.URL,t.UI_FloatScore),fairygui.UIObjectFactory.setPackageItemExtension(t.UI_Btn_pause.URL,t.UI_Btn_pause),fairygui.UIObjectFactory.setPackageItemExtension(t.UI_Btn_rank.URL,t.UI_Btn_rank),fairygui.UIObjectFactory.setPackageItemExtension(t.UI_Btn_share.URL,t.UI_Btn_share),fairygui.UIObjectFactory.setPackageItemExtension(t.UI_Btn_star.URL,t.UI_Btn_star)},e}();t.gameBinder=e,__reflect(e.prototype,"game.gameBinder")}(game||(game={}));var game;!function(t){var e=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.createInstance=function(){return fairygui.UIPackage.createObject("game","Btn_pause")},e.prototype.constructFromXML=function(e){t.prototype.constructFromXML.call(this,e),this.m_button=this.getControllerAt(0),this.m_n1=this.getChildAt(0)},e.URL="ui://7cac2uhfrzcxu",e}(fairygui.GButton);t.UI_Btn_pause=e,__reflect(e.prototype,"game.UI_Btn_pause")}(game||(game={}));var game;!function(t){var e=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.createInstance=function(){return fairygui.UIPackage.createObject("game","Btn_rank")},e.prototype.constructFromXML=function(e){t.prototype.constructFromXML.call(this,e),this.m_button=this.getControllerAt(0),this.m_n1=this.getChildAt(0)},e.URL="ui://7cac2uhfrzcxv",e}(fairygui.GButton);t.UI_Btn_rank=e,__reflect(e.prototype,"game.UI_Btn_rank")}(game||(game={}));var game;!function(t){var e=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.createInstance=function(){return fairygui.UIPackage.createObject("game","Btn_share")},e.prototype.constructFromXML=function(e){t.prototype.constructFromXML.call(this,e),this.m_button=this.getControllerAt(0),this.m_n1=this.getChildAt(0)},e.URL="ui://7cac2uhfrzcxw",e}(fairygui.GButton);t.UI_Btn_share=e,__reflect(e.prototype,"game.UI_Btn_share")}(game||(game={}));var game;!function(t){var e=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.createInstance=function(){return fairygui.UIPackage.createObject("game","Btn_star")},e.prototype.constructFromXML=function(e){t.prototype.constructFromXML.call(this,e),this.m_button=this.getControllerAt(0),this.m_n1=this.getChildAt(0)},e.URL="ui://7cac2uhfrzcxx",e}(fairygui.GButton);t.UI_Btn_star=e,__reflect(e.prototype,"game.UI_Btn_star")}(game||(game={}));var game;!function(t){var e=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.createInstance=function(){return fairygui.UIPackage.createObject("game","BtnRestart")},e.prototype.constructFromXML=function(e){t.prototype.constructFromXML.call(this,e),this.m_button=this.getControllerAt(0),this.m_n2=this.getChildAt(0)},e.URL="ui://7cac2uhfhlxd9",e}(fairygui.GButton);t.UI_BtnRestart=e,__reflect(e.prototype,"game.UI_BtnRestart")}(game||(game={}));var core;!function(t){var e=function(e){function o(){var o=e.call(this)||this;return o.touchEnabled=!1,o.touchChildren=!1,o.loop=t.FrameEventCenter.getInstance(),o}return __extends(o,e),o.prototype.play=function(){this.loop.addFrameEventListener(this.onRenderLoop,this)},o.prototype.stop=function(){this.loop.removeFrameEventListener(this.onRenderLoop,this)},o.prototype.onRenderLoop=function(t){null==this.parent&&this.stop()},o}(t.Component);t.Animation=e,__reflect(e.prototype,"core.Animation")}(core||(core={}));var game;!function(t){var e=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.createInstance=function(){return fairygui.UIPackage.createObject("game","GameOverPanel")},e.prototype.constructFromXML=function(e){t.prototype.constructFromXML.call(this,e),this.m_n0=this.getChildAt(0),this.m_btn_restart=this.getChildAt(1),this.m_txt_now=this.getChildAt(2),this.m_n8=this.getChildAt(3),this.m_n9=this.getChildAt(4),this.m_n10=this.getChildAt(5),this.m_n11=this.getChildAt(6),this.m_txt_max=this.getChildAt(7),this.m_n13=this.getChildAt(8)},e.URL="ui://7cac2uhfhlxd8",e}(fairygui.GComponent);t.UI_GameOverPanel=e,__reflect(e.prototype,"game.UI_GameOverPanel")}(game||(game={}));var game;!function(t){var e=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.createInstance=function(){return fairygui.UIPackage.createObject("game","TopUI")},e.prototype.constructFromXML=function(e){t.prototype.constructFromXML.call(this,e),this.m_txt_score=this.getChildAt(0),this.m_btn_pause=this.getChildAt(1)},e.URL="ui://7cac2uhfhlxda",e}(fairygui.GComponent);t.UI_TopUI=e,__reflect(e.prototype,"game.UI_TopUI")}(game||(game={}));var LayerCenter=function(){function t(){}return Object.defineProperty(t,"Instance",{get:function(){return null==t.s_instance&&(t.s_instance=new t),t.s_instance},enumerable:!0,configurable:!0}),t.prototype.init=function(e){e&&(this.stage=e,e.addEventListener(egret.Event.RESIZE,this.onStageResize,this),this.m_layerDic=new Dictionary,t.stageWidth=e.stageWidth,t.stageHeight=e.stageHeight,this.stage.addChild(fairygui.GRoot.inst.displayObject)),this.initLayers()},t.prototype.initLayers=function(){this.addLayer(LayerEnum.SCENE,new SceneModuleLayer),this.addLayer(LayerEnum.UI,new UIModuleLayer),this.addLayer(LayerEnum.STATIC,new StaticModuleLayer),this.addLayer(LayerEnum.POPUP,new PopModuleLayer),this.addLayer(LayerEnum.TOP,new TopModuleLayer)},t.prototype.addLayer=function(t,e){this.m_layerDic.add(t,e),egret.callLater(this.updateLayer,this)},t.prototype.onStageResize=function(e){t.stageWidth=this.stage.stageWidth,t.stageHeight=this.stage.stageHeight,fairygui.GRoot.inst.setSize(t.stageWidth,t.stageHeight),App.EventCenter.dispatch(egret.Event.RESIZE)},t.prototype.updateLayer=function(){var t=this.m_layerDic.keys.concat();t.sort(function(t,e){return t-e});for(var e=0,o=t.length;o>e;e++){var r=this.m_layerDic.get(t[e]);r.parent?fairygui.GRoot.inst.setChildIndex(r,e):fairygui.GRoot.inst.addChildAt(r,e)}},t.prototype.getLayer=function(t){return this.m_layerDic.get(t)},t.prototype.removeLayer=function(t){var e=this.m_layerDic.remove(t);return this.updateLayer(),e},t}();__reflect(LayerCenter.prototype,"LayerCenter");var DebugPlatform=function(){function t(){}return t.prototype.getUserInfo=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2,{nickName:"username"}]})})},t.prototype.login=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2]})})},t}();__reflect(DebugPlatform.prototype,"DebugPlatform",["Platform"]),window.platform||(window.platform=new DebugPlatform);var ModuleMgr=function(){function t(){this.m_configLib=new Object}return Object.defineProperty(t,"ins",{get:function(){return null==t.s_instance&&(t.s_instance=new t),t.s_instance},enumerable:!0,configurable:!0}),t.prototype.getStaticLayer=function(){return LayerCenter.Instance.getLayer(LayerEnum.STATIC)},t.prototype.regModule=function(t){this.m_configLib[t.moduleId]=t},t.prototype.getConfigVo=function(t){var e=this.m_configLib[t];return null==e?void egret.log("未注册的moduleId:",t):e},t.prototype.showModule=function(t,e,o){var r=this.getConfigVo(t);if(null!=r){var n=LayerCenter.Instance.getLayer(r.layerKind),i=n.showModule(t,e,o);return i}},t.prototype.isShow=function(t){var e=this.m_configLib[t];if(e){var o=LayerCenter.Instance.getLayer(e.layerKind);return o.isShow(t)}return!1},t.prototype.closeModule=function(t,e){var o=this.getConfigVo(t);if(null!=o){var r=LayerCenter.Instance.getLayer(o.layerKind);r.closeModule(t,e)}},t.prototype.loadSkins=function(t){},t}();__reflect(ModuleMgr.prototype,"ModuleMgr");var LayerEnum;!function(t){t[t.SCENE=0]="SCENE",t[t.UI=1]="UI",t[t.STATIC=2]="STATIC",t[t.POPUP=3]="POPUP",t[t.TOP=4]="TOP"}(LayerEnum||(LayerEnum={}));var ModuleConsts=function(){function t(){}return t.MODULE_SERVER_CPL="MODULE_SERVER_CPL",t.MODULE_PRE_SHOW_CPL="MODULE_PRE_SHOW_CPL",t.MODULE_PRE_CLOSE_CPL="MODULE_PRE_CLOSE_CPL",t.MODULE_CLOSE_CPL="MODULE_CLOSE_CPL",t.MODULE_ADD_TO_STAGE="MODULE_ADD_TO_STAGE",t.MODULE_FADE_IN_CPL="MODULE_FADE_IN_CPL",t.MODULE_FADE_OUT_CPL="MODULE_FADE_OUT_CPL",t.MODULE_FADE_IN_TYPE_0=0,t.MODULE_FADE_IN_TYPE_1=1,t.MODULE_FADE_IN_TYPE_2=2,t.MODULE_FADE_OUT_TYPE_0=0,t.MODULE_FADE_OUT_TYPE_1=1,t.MODULE_FADE_OUT_TYPE_2=2,t.STATE_NULL=0,t.STATE_SHOW=1,t.STATE_CLOSE=3,t.STATE_DISPOSE=4,t.PHASE_LOAD_ASSET=11,t.PHASE_SERVER=12,t.PHASE_PRE_SHOW=13,t.PHASE_MODULE_FADE_IN=14,t.PHASE_SHOW=15,t.PHASE_PRE_CLOSE=21,t.PHASE_MODULE_FADE_OUT=22,t.PHASE_CLOSE=23,t}();__reflect(ModuleConsts.prototype,"ModuleConsts");var ModuleEnum;!function(t){t[t.NONE=0]="NONE",t[t.LOADING=1]="LOADING",t[t.GAME=2]="GAME",t[t.GameOver=3]="GameOver",t[t.GAME_TOP=4]="GAME_TOP"}(ModuleEnum||(ModuleEnum={}));var HistoryModuleVo=function(){function t(t,e,o){this.moduleId=t,this.data=e,this.historyData=o}return t}();__reflect(HistoryModuleVo.prototype,"HistoryModuleVo");var ModuleConfigVo=function(){function t(){this.m_disposeWhenClose=!0,this.m_showCover=!1}return Object.defineProperty(t.prototype,"isAutoSize",{get:function(){return this.m_isAutoSize},enumerable:!0,configurable:!0}),t.prototype.setIsAutoSize=function(t){return this.m_isAutoSize=t,this},Object.defineProperty(t.prototype,"disposeWhenClose",{get:function(){return this.m_disposeWhenClose},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"showCover",{get:function(){return this.m_showCover},enumerable:!0,configurable:!0}),t.prototype.setShowCover=function(t){return this.m_showCover=t,this},t.prototype.setDisposeWhenClose=function(t){return 0==t&&this.layerKind==LayerEnum.POPUP?(egret.error("popup层不能设置disposeWhenClose为false"),this):(this.m_disposeWhenClose=t,this)},t}();__reflect(ModuleConfigVo.prototype,"ModuleConfigVo");var ModuleInfoVo=function(t){function e(e){var o=t.call(this)||this;return o.state=0,o.phase=0,o.moduleId=e.moduleId,o.configVo=e,o}return __extends(e,t),e.prototype.changeModuleState=function(t){if(this.state!=t){var e=this.state;if(this.state=t,e==ModuleConsts.STATE_NULL)t==ModuleConsts.STATE_SHOW&&this.startShow();else if(e==ModuleConsts.STATE_SHOW)switch(this.phase){case ModuleConsts.PHASE_LOAD_ASSET:case ModuleConsts.PHASE_SERVER:case ModuleConsts.PHASE_PRE_SHOW:case ModuleConsts.PHASE_MODULE_FADE_IN:t==ModuleConsts.STATE_CLOSE||(this.removeAllListeners(),this.preClose());break;case ModuleConsts.PHASE_SHOW:this.removeAllListeners(),this.preClose()}else if(e==ModuleConsts.STATE_CLOSE)switch(this.phase){case ModuleConsts.PHASE_PRE_CLOSE:this.removeAllListeners(),this.show();break;case ModuleConsts.PHASE_MODULE_FADE_OUT:case ModuleConsts.PHASE_CLOSE:null==this.module.content.parent&&this.layer.addChild(this.module.content),this.removeAllListeners(),this.moduleFadeIn()}}},e.prototype.startShow=function(){if(this.state=ModuleConsts.STATE_SHOW,null==this.module){this.module=new this.configVo.moduleCls,this.module.moduleInfoVo=this,this.isShow=!0;var t=this.configVo.groupNames.slice();if(t&&t.length>0){var e=core.LoadingManager.getCurLoading();e&&e.show(),this.phase=ModuleConsts.PHASE_LOAD_ASSET,core.ResUtils.loadGroups(t,this.onLoadProgress,this.onLoadFaild,this.onLoadComplete,this)}else this.initAll()}else this.isShow=!0,this.initAll()},e.prototype.initAll=function(){this.module.initContentAll(),this.moduleServerStart()},e.prototype.moduleServerStart=function(){this.state==ModuleConsts.STATE_SHOW&&(this.phase=ModuleConsts.PHASE_LOAD_ASSET,this.module.addEventListener(ModuleConsts.MODULE_SERVER_CPL,this.onModuleServerCpl,this),this.module.moduleServerStart(this.preShowData))},e.prototype.onModuleServerCpl=function(t){this.module.removeEventListener(ModuleConsts.MODULE_SERVER_CPL,this.onModuleServerCpl,this),this.preShow()},e.prototype.preShow=function(){this.state==ModuleConsts.STATE_SHOW&&(this.phase=ModuleConsts.PHASE_PRE_SHOW,this.module.addEventListener(ModuleConsts.MODULE_PRE_SHOW_CPL,this.onModulePreShowCpl,this),this.module.preShow(this.preShowData))},e.prototype.onModulePreShowCpl=function(t){var e=core.LoadingManager.getCurLoading();e&&e.hide(),this.module.initAutoSize(this.layer,this.configVo.isAutoSize),this.layer.addChild(this.module.content),this.dispatchEvent(new egret.Event(ModuleConsts.MODULE_ADD_TO_STAGE)),this.moduleFadeIn()},e.prototype.moduleFadeIn=function(){this.state==ModuleConsts.STATE_SHOW&&(this.phase=ModuleConsts.PHASE_MODULE_FADE_IN,this.isShow=!0,this.module.addEventListener(ModuleConsts.MODULE_FADE_IN_CPL,this.onModuleFadeInCpl,this),this.module.moduleFadeIn())},e.prototype.onModuleFadeInCpl=function(t){this.module.removeEventListener(ModuleConsts.MODULE_FADE_IN_CPL,this.onModuleFadeInCpl,this),this.show()},e.prototype.show=function(){this.state==ModuleConsts.STATE_SHOW&&(this.phase=ModuleConsts.PHASE_SHOW,this.module.show(this.preShowData))},e.prototype.preClose=function(){this.phase=ModuleConsts.PHASE_PRE_CLOSE,this.module.addEventListener(ModuleConsts.MODULE_PRE_CLOSE_CPL,this.onModulePreCloseCpl,this),this.module.preClose(this.preShowData)},e.prototype.onModulePreCloseCpl=function(t){this.isShow=!1,this.module.removeEventListener(ModuleConsts.MODULE_PRE_CLOSE_CPL,this.onModulePreCloseCpl,this),this.moduleFadeOut()},e.prototype.moduleFadeOut=function(){this.phase=ModuleConsts.PHASE_MODULE_FADE_OUT,this.module.addEventListener(ModuleConsts.MODULE_FADE_OUT_CPL,this.onModuleFadeOutCpl,this),this.module.moduleFadeOut()},e.prototype.onModuleFadeOutCpl=function(t){this.module.removeEventListener(ModuleConsts.MODULE_FADE_OUT_CPL,this.onModuleFadeOutCpl,this),this.doRelease()},e.prototype.doRelease=function(){this.phase=ModuleConsts.PHASE_CLOSE,this.configVo.disposeWhenClose?(this.state=ModuleConsts.STATE_DISPOSE,this.module.release()):this.module.hide(),this.dispatchEvent(new egret.Event(ModuleConsts.MODULE_CLOSE_CPL))},e.prototype.release=function(){this.removeAllListeners(),this.module=null,this.layer=null},e.prototype.getHistoryData=function(){return null!=this.module?this.module.getHistoryData():null},e.prototype.removeAllListeners=function(){this.module&&(this.module.removeEventListener(ModuleConsts.MODULE_SERVER_CPL,this.onModuleServerCpl,this),this.module.removeEventListener(ModuleConsts.MODULE_PRE_SHOW_CPL,this.onModulePreShowCpl,this),this.module.removeEventListener(ModuleConsts.MODULE_FADE_IN_CPL,this.onModuleFadeInCpl,this),this.module.removeEventListener(ModuleConsts.MODULE_PRE_CLOSE_CPL,this.onModulePreCloseCpl,this),this.module.removeEventListener(ModuleConsts.MODULE_FADE_OUT_CPL,this.onModuleFadeOutCpl,this))},e.prototype.onLoadProgress=function(t){var e=core.LoadingManager.getCurLoading();e&&e.setProgress(t)},e.prototype.onLoadFaild=function(t){egret.log("资源组"+t.curGroup+"加载失败, 失败URL："+t.curResItem.url)},e.prototype.onLoadComplete=function(t){for(var e=0;e<this.configVo.groupNames.length;e++){var o=this.configVo.groupNames[e],r=RES.getRes(o);r||(r=RES.getRes(o+"_fui")),r&&fairygui.UIPackage.addPackage(this.configVo.groupNames[e])}this.initAll()},e}(egret.EventDispatcher);__reflect(ModuleInfoVo.prototype,"ModuleInfoVo");var PopModuleLayer=function(t){function e(){var e=t.call(this)||this;return e.cover=new fairygui.GGraph,e.cover.touchable=!0,e.cover.graphics,e.drawCover(),App.EventCenter.addListener(egret.Event.RESIZE,e.onStageResize,e),e}return __extends(e,t),e.prototype.onStageResize=function(t){this.drawCover()},e.prototype.drawCover=function(){this.cover.graphics.clear(),this.cover.graphics.beginFill(0,.2),this.cover.graphics.drawRect(0,0,LayerCenter.stageWidth,LayerCenter.stageHeight),this.cover.graphics.endFill()},e.prototype.onCoverTouch=function(t){var e=this.getCurModuleId();e>0&&this.closeModule(e)},e.prototype.showModule=function(t,e,o){var r=ModuleMgr.ins.getConfigVo(t);if(null!=r){var n=new ModuleInfoVo(r);return this.p_moduleList.push(n),n.preShowData=e,n.layer=this,n.addEventListener(ModuleConsts.MODULE_ADD_TO_STAGE,this.onModuleAddToStage,this),n.changeModuleState(ModuleConsts.STATE_SHOW),n}},e.prototype.onCloseCpl=function(e){t.prototype.onCloseCpl.call(this,e),this.updateModuleVisible()},e.prototype.onModuleAddToStage=function(t){this.updateModuleVisible()},e.prototype.updateModuleVisible=function(){if(this.p_moduleList.length>0){for(var t=0;t<this.p_moduleList.length;t++)t<this.p_moduleList.length-2?this.p_moduleList[t].module.setVisible(!1):this.p_moduleList[t].module.setVisible(!0);this.p_moduleList[this.p_moduleList.length-1]}this.updateConver()},e.prototype.updateConver=function(){for(var t=this.p_moduleList.length-1;t>=0;t--)if(this.p_moduleList[t].configVo.showCover)return void core.DisplayUtil.getInstance().addChildBelow(this.cover,this.p_moduleList[t].module.content);this.cover.parent&&this.cover.parent.removeChild(this.cover)},e}(UILayer);__reflect(PopModuleLayer.prototype,"PopModuleLayer");var App=function(){function t(){}return Object.defineProperty(t,"TimerManager",{get:function(){return core.TimerManager.getInstance()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"DebugUtils",{get:function(){return core.DebugUtils.getInstance()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"RandomUtils",{get:function(){return core.RandomUtils.getInstance()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"DisplayUtils",{get:function(){return core.DisplayUtil.getInstance()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"MathUtils",{get:function(){return core.MathUtils.getInstance()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"ResourceUtils",{get:function(){return core.ResourceUtils.getInstance()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"DeviceUtils",{get:function(){return core.DeviceUtils.getInstance()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"ShockUtils",{get:function(){return core.ShockUtils.getInstance()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"EgretExpandUtils",{get:function(){return core.EgretExpandUtils.getInstance()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"EventCenter",{get:function(){return null==t._eventCenter&&(t._eventCenter=new core.MessageCenter(1)),t._eventCenter},enumerable:!0,configurable:!0}),Object.defineProperty(t,"MessageCenter",{get:function(){return core.MessageCenter.getInstance(0)},enumerable:!0,configurable:!0}),Object.defineProperty(t,"StageUtils",{get:function(){return core.StageUtils.getInstance()},enumerable:!0,configurable:!0}),t.run=function(e){egret.ImageLoader.crossOrigin="anonymous",t.GlobalData=RES.getRes("config_json"),t.DebugUtils.isOpen(t.GlobalData.IsDebug),t.DebugUtils.setThreshold(5),t.EgretExpandUtils.init(),core.FrameEventCenter.getInstance().init(e),egret.Capabilities.runtimeType==egret.RuntimeType.WEB&&(core.WebUtils.addKeyboardListener(),egret.Logger.logLevel=egret.Logger.ALL),RES.setMaxRetryTimes(2)},t.GlobalData=null,t}();__reflect(App.prototype,"App");var SceneModuleLayer=function(t){function e(){return t.call(this)||this}return __extends(e,t),e}(UIModuleLayer);__reflect(SceneModuleLayer.prototype,"SceneModuleLayer");var StaticModuleLayer=function(t){function e(){var e=t.call(this)||this;return e.cover=new egret.Sprite,e.cover.touchEnabled=!0,e.drawCover(),e}return __extends(e,t),e.prototype.drawCover=function(){this.cover.graphics.clear(),this.cover.graphics.beginFill(0,.2),this.cover.graphics.drawRect(0,0,LayerCenter.stageWidth,LayerCenter.stageHeight),this.cover.graphics.endFill()},e}(UILayer);__reflect(StaticModuleLayer.prototype,"StaticModuleLayer");var TopModuleLayer=function(t){function e(){var e=t.call(this)||this;return e.cover=new egret.Sprite,e.cover.touchEnabled=!0,e.drawCover(),App.EventCenter.addListener(egret.Event.RESIZE,e.onStageResize,e),e}return __extends(e,t),e.prototype.onStageResize=function(t){this.drawCover()},e.prototype.drawCover=function(){this.cover.graphics.clear(),this.cover.graphics.beginFill(0,.2),this.cover.graphics.drawRect(0,0,LayerCenter.stageWidth,LayerCenter.stageHeight),this.cover.graphics.endFill()},e.prototype.onModuleAddToStage=function(t){this.updateConver()},e.prototype.onCloseCpl=function(e){t.prototype.onCloseCpl.call(this,e),this.updateConver()},e.prototype.updateConver=function(){for(var t=this.p_moduleList.length-1;t>=0;t--)if(this.p_moduleList[t].configVo.showCover)return void core.DisplayUtil.getInstance().addChildBelow(this.cover,this.p_moduleList[t].module.content);this.cover.parent&&this.cover.parent.removeChild(this.cover)},e}(UILayer);__reflect(TopModuleLayer.prototype,"TopModuleLayer");var core;!function(t){var e=function(){function t(){this.m_callbacks=[]}return t.getInstance=function(){return null==t.s_instance&&(t.s_instance=new t),t.s_instance},t.prototype.init=function(t){this.m_stage=t,this.m_stage?(this.m_preTick=Date.now(),this.m_stage.addEventListener(egret.Event.ENTER_FRAME,this.onEnterFrame,this)):egret.log("Stage为null不能开启帧循环监听")},t.prototype.onEnterFrame=function(t){var e=Date.now(),o=this.m_callbacks;if(o){for(var r=o.length;r>0;r--){var n=o[r-1];n.isValid||o.splice(r-1,1)}for(var r=0,i=o.length;i>r;r++){var n=o[r];n.isValid&&n.callback&&n.callback.call(n.thisObj,e-this.m_preTick)}}this.m_preTick=e},t.prototype.addFrameEventListener=function(t,e){if(t&&e){var r=new o(t,e);this.m_callbacks.push(r)}},t.prototype.removeFrameEventListener=function(t,e){var o=this.m_callbacks;if(o)for(var r=0,n=o.length;n>r;r++){var i=o[r];i.callback===t&&i.thisObj===e&&(i.isValid=!1)}},t}();t.FrameEventCenter=e,__reflect(e.prototype,"core.FrameEventCenter");var o=function(t){function e(e,o){var r=t.call(this,e,o)||this;return r.isValid=!0,r}return __extends(e,t),e.prototype.clone=function(){var t=new e(this.callback,this.thisObj);return t.index=this.index,t.isValid=this.isValid,t},e}(t.Callback);__reflect(o.prototype,"FrameCallBack")}(core||(core={}));var core;!function(t){var e=function(){function t(t){this.data=t}return t}();t.Node=e,__reflect(e.prototype,"core.Node")}(core||(core={}));var Utils=function(){function t(){}return t.createBitmapByName=function(t){var e=new egret.Bitmap,o=RES.getRes(t);return e.texture=o,e},t.createFairyGuiBitmapByName=function(t){var e=new egret.Bitmap,o=fairygui.UIPackage.createObject("game",t);return e.texture=o.texture,e},t.floatScore=function(t,e){egret.Tween.get(t).to({x:e.x-t.width/2,y:e.y-t.height/2},300).call(function(){t.visible=!1,GameModel.ins.score=GameModel.ins.scoreSign},this)},t}();__reflect(Utils.prototype,"Utils");